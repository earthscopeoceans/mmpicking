module ttak135

! QUICK AND DIRTY (=linear) interpolation of the official AK135 travel 
! time tables

! Note: especially at close distances thes estimates can be several seconds
! off with respect to properly computed AK135 times. But they have the
! advantage that no iteration is needed and you'll always get an answer.

contains

real*4 function Ptime(dist,dep)

! computes travel time of P or Pdiffracted wave, 0<dist<125 deg, 0<dep<700
! returns -12345. if dist or dep outside range
! Interpolates AK135 tables

implicit none
integer :: i0,i1,j0,j1
real*4 :: d0,t0,t1,x,y
integer :: jdebug=0
real*4 :: dist,dep     ! distance and depth of the earthquake
real*4 :: dmin,dmax,time(102,17),depth(17)
data dmin,dmax /    0.,  101./
data depth /   0.,  15.,  35.,  50., 100., 150., 200., 250.,  &
  300., 350., 400., 450., 500., 550., 600., 650., 700./
data time(  1,1: 8)/   0.0,   2.6,   5.8,   7.6,  13.8,  20.0,  26.1,  32.1/
data time(  2,1: 8)/  19.2,  19.0,  17.5,  17.7,  20.4,  24.7,  29.7,  35.0/
data time(  3,1: 8)/  35.0,  33.2,  31.3,  31.3,  32.5,  35.1,  38.5,  42.4/
data time(  4,1: 8)/  48.8,  47.0,  45.0,  45.0,  45.7,  47.3,  49.6,  52.4/
data time(  5,1: 8)/  62.5,  60.7,  58.8,  58.7,  59.1,  60.2,  61.7,  63.8/
data time(  6,1: 8)/  76.3,  74.5,  72.5,  72.4,  72.7,  73.4,  74.3,  75.7/
data time(  7,1: 8)/  90.0,  88.2,  86.3,  86.2,  86.2,  86.6,  87.2,  88.1/
data time(  8,1: 8)/ 103.8, 101.9, 100.0,  99.9,  99.8, 100.0, 100.2, 100.6/
data time(  9,1: 8)/ 117.5, 115.7, 113.7, 113.6, 113.4, 113.3, 113.2, 113.2/
data time( 10,1: 8)/ 131.2, 129.4, 127.4, 127.3, 127.0, 126.7, 126.2, 125.9/
data time( 11,1: 8)/ 144.9, 143.1, 141.1, 141.0, 140.6, 139.9, 139.2, 138.5/
data time( 12,1: 8)/ 158.6, 156.8, 154.8, 154.6, 154.2, 153.1, 152.1, 151.1/
data time( 13,1: 8)/ 172.3, 170.5, 168.5, 168.3, 167.6, 166.2, 164.8, 163.5/
data time( 14,1: 8)/ 185.9, 184.1, 182.1, 181.9, 180.8, 179.1, 177.4, 175.9/
data time( 15,1: 8)/ 199.6, 197.8, 195.8, 195.6, 193.8, 191.8, 189.9, 188.1/
data time( 16,1: 8)/ 213.2, 211.4, 209.3, 208.8, 206.6, 204.3, 202.1, 199.7/
data time( 17,1: 8)/ 226.4, 224.5, 222.3, 221.6, 219.2, 216.6, 213.8, 210.7/
data time( 18,1: 8)/ 239.1, 237.2, 235.0, 234.2, 231.5, 228.2, 224.8, 221.7/
data time( 19,1: 8)/ 251.6, 249.6, 247.3, 246.5, 242.8, 239.1, 235.7, 232.5/
data time( 20,1: 8)/ 263.2, 261.0, 258.6, 257.4, 253.7, 250.0, 246.6, 243.3/
data time( 21,1: 8)/ 274.1, 272.0, 269.5, 268.4, 264.6, 260.8, 257.3, 253.9/
data time( 22,1: 8)/ 285.0, 282.8, 280.3, 279.2, 275.3, 271.5, 267.9, 264.5/
data time( 23,1: 8)/ 295.7, 293.6, 291.1, 289.9, 286.0, 282.1, 278.1, 273.9/
data time( 24,1: 8)/ 306.3, 304.2, 301.6, 300.5, 296.2, 291.6, 287.2, 283.0/
data time( 25,1: 8)/ 316.3, 314.0, 311.3, 309.9, 305.3, 300.7, 296.3, 292.1/
data time( 26,1: 8)/ 325.4, 323.1, 320.4, 319.0, 314.4, 309.8, 305.4, 301.1/
data time( 27,1: 8)/ 334.5, 332.2, 329.5, 328.1, 323.5, 318.8, 314.4, 310.1/
data time( 28,1: 8)/ 343.5, 341.3, 338.5, 337.1, 332.4, 327.8, 323.3, 319.0/
data time( 29,1: 8)/ 352.5, 350.2, 347.5, 346.1, 341.4, 336.7, 332.2, 327.9/
data time( 30,1: 8)/ 361.4, 359.1, 356.4, 355.0, 350.2, 345.6, 341.0, 336.7/
data time( 31,1: 8)/ 370.3, 368.0, 365.2, 363.8, 359.1, 354.4, 349.9, 345.5/
data time( 32,1: 8)/ 379.1, 376.8, 374.1, 372.6, 367.9, 363.2, 358.6, 354.3/
data time( 33,1: 8)/ 387.9, 385.6, 382.9, 381.4, 376.7, 372.0, 367.4, 363.0/
data time( 34,1: 8)/ 396.7, 394.4, 391.6, 390.2, 385.4, 380.7, 376.1, 371.7/
data time( 35,1: 8)/ 405.4, 403.1, 400.3, 398.9, 394.1, 389.3, 384.7, 380.3/
data time( 36,1: 8)/ 414.1, 411.8, 409.0, 407.5, 402.7, 397.9, 393.3, 388.8/
data time( 37,1: 8)/ 422.7, 420.3, 417.6, 416.1, 411.3, 406.5, 401.8, 397.3/
data time( 38,1: 8)/ 431.2, 428.9, 426.1, 424.6, 419.8, 414.9, 410.3, 405.7/
data time( 39,1: 8)/ 439.7, 437.4, 434.6, 433.1, 428.2, 423.4, 418.6, 414.1/
data time( 40,1: 8)/ 448.1, 445.8, 443.0, 441.5, 436.6, 431.7, 427.0, 422.4/
data time( 41,1: 8)/ 456.4, 454.1, 451.3, 449.8, 444.9, 440.0, 435.2, 430.6/
data time( 42,1: 8)/ 464.7, 462.4, 459.6, 458.1, 453.1, 448.2, 443.4, 438.8/
data time( 43,1: 8)/ 472.9, 470.6, 467.8, 466.3, 461.3, 456.3, 451.5, 446.9/
data time( 44,1: 8)/ 481.0, 478.7, 475.9, 474.4, 469.4, 464.4, 459.6, 454.9/
data time( 45,1: 8)/ 489.1, 486.8, 483.9, 482.4, 477.4, 472.4, 467.5, 462.8/
data time( 46,1: 8)/ 497.1, 494.8, 491.9, 490.4, 485.3, 480.3, 475.4, 470.7/
data time( 47,1: 8)/ 505.0, 502.7, 499.8, 498.3, 493.2, 488.2, 483.3, 478.5/
data time( 48,1: 8)/ 512.9, 510.5, 507.7, 506.1, 501.0, 496.0, 491.0, 486.3/
data time( 49,1: 8)/ 520.7, 518.3, 515.5, 513.9, 508.8, 503.7, 498.7, 493.9/
data time( 50,1: 8)/ 528.4, 526.0, 523.2, 521.6, 516.4, 511.3, 506.4, 501.5/
data time( 51,1: 8)/ 536.0, 533.6, 530.8, 529.2, 524.0, 518.9, 513.9, 509.0/
data time( 52,1: 8)/ 543.6, 541.2, 538.3, 536.8, 531.6, 526.4, 521.4, 516.5/
data time( 53,1: 8)/ 551.0, 548.7, 545.8, 544.2, 539.0, 533.8, 528.8, 523.9/
data time( 54,1: 8)/ 558.5, 556.1, 553.2, 551.6, 546.4, 541.2, 536.1, 531.2/
data time( 55,1: 8)/ 565.8, 563.4, 560.5, 559.0, 553.7, 548.5, 543.4, 538.4/
data time( 56,1: 8)/ 573.1, 570.7, 567.8, 566.2, 560.9, 555.7, 550.6, 545.6/
data time( 57,1: 8)/ 580.3, 577.9, 575.0, 573.4, 568.1, 562.8, 557.7, 552.7/
data time( 58,1: 8)/ 587.4, 585.0, 582.1, 580.5, 575.2, 569.9, 564.7, 559.7/
data time( 59,1: 8)/ 594.5, 592.0, 589.1, 587.5, 582.2, 576.9, 571.7, 566.7/
data time( 60,1: 8)/ 601.4, 599.0, 596.1, 594.5, 589.1, 583.8, 578.6, 573.6/
data time( 61,1: 8)/ 608.3, 605.9, 603.0, 601.4, 596.0, 590.7, 585.5, 580.4/
data time( 62,1: 8)/ 615.2, 612.8, 609.8, 608.2, 602.8, 597.5, 592.2, 587.1/
data time( 63,1: 8)/ 621.9, 619.5, 616.6, 615.0, 609.5, 604.2, 598.9, 593.8/
data time( 64,1: 8)/ 628.6, 626.2, 623.3, 621.6, 616.2, 610.8, 605.5, 600.4/
data time( 65,1: 8)/ 635.2, 632.8, 629.9, 628.2, 622.8, 617.4, 612.1, 606.9/
data time( 66,1: 8)/ 641.8, 639.3, 636.4, 634.8, 629.3, 623.8, 618.5, 613.3/
data time( 67,1: 8)/ 648.3, 645.8, 642.9, 641.2, 635.7, 630.3, 624.9, 619.7/
data time( 68,1: 8)/ 654.7, 652.2, 649.3, 647.6, 642.1, 636.6, 631.3, 626.0/
data time( 69,1: 8)/ 661.0, 658.5, 655.6, 653.9, 648.4, 642.9, 637.5, 632.3/
data time( 70,1: 8)/ 667.2, 664.8, 661.8, 660.2, 654.6, 649.1, 643.7, 638.5/
data time( 71,1: 8)/ 673.4, 671.0, 668.0, 666.3, 660.8, 655.2, 649.8, 644.6/
data time( 72,1: 8)/ 679.5, 677.1, 674.1, 672.4, 666.8, 661.3, 655.9, 650.6/
data time( 73,1: 8)/ 685.5, 683.1, 680.1, 678.4, 672.8, 667.3, 661.8, 656.5/
data time( 74,1: 8)/ 691.5, 689.0, 686.1, 684.4, 678.8, 673.2, 667.8, 662.4/
data time( 75,1: 8)/ 697.4, 694.9, 692.0, 690.3, 684.6, 679.0, 673.6, 668.2/
data time( 76,1: 8)/ 703.2, 700.8, 697.8, 696.1, 690.4, 684.8, 679.3, 674.0/
data time( 77,1: 8)/ 709.0, 706.5, 703.5, 701.8, 696.1, 690.5, 685.0, 679.6/
data time( 78,1: 8)/ 714.6, 712.2, 709.2, 707.5, 701.8, 696.1, 690.6, 685.2/
data time( 79,1: 8)/ 720.2, 717.7, 714.7, 713.0, 707.3, 701.7, 696.2, 690.8/
data time( 80,1: 8)/ 725.7, 723.3, 720.3, 718.5, 712.8, 707.2, 701.6, 696.2/
data time( 81,1: 8)/ 731.2, 728.7, 725.7, 724.0, 718.3, 712.6, 707.0, 701.6/
data time( 82,1: 8)/ 736.6, 734.1, 731.0, 729.3, 723.6, 717.9, 712.3, 706.9/
data time( 83,1: 8)/ 741.8, 739.4, 736.3, 734.6, 728.9, 723.2, 717.6, 712.1/
data time( 84,1: 8)/ 747.1, 744.6, 741.6, 739.8, 734.1, 728.3, 722.7, 717.3/
data time( 85,1: 8)/ 752.2, 749.7, 746.7, 745.0, 739.2, 733.5, 727.8, 722.3/
data time( 86,1: 8)/ 757.3, 754.8, 751.8, 750.0, 744.2, 738.5, 732.8, 727.3/
data time( 87,1: 8)/ 762.3, 759.8, 756.7, 755.0, 749.2, 743.4, 737.8, 732.2/
data time( 88,1: 8)/ 767.2, 764.7, 761.6, 759.9, 754.1, 748.3, 742.6, 737.1/
data time( 89,1: 8)/ 772.0, 769.5, 766.4, 764.7, 758.8, 753.0, 747.4, 741.8/
data time( 90,1: 8)/ 776.7, 774.2, 771.2, 769.4, 763.6, 757.8, 752.1, 746.5/
data time( 91,1: 8)/ 781.4, 778.9, 775.8, 774.1, 768.2, 762.4, 756.7, 751.2/
data time( 92,1: 8)/ 786.0, 783.5, 780.5, 778.7, 772.9, 767.1, 761.4, 755.8/
data time( 93,1: 8)/ 790.7, 788.2, 785.1, 783.4, 777.5, 771.7, 766.0, 760.4/
data time( 94,1: 8)/ 795.3, 792.8, 789.7, 788.0, 782.1, 776.3, 770.6, 765.0/
data time( 95,1: 8)/ 799.9, 797.4, 794.3, 792.6, 786.7, 780.9, 775.2, 769.6/
data time( 96,1: 8)/ 804.5, 802.0, 798.9, 797.2, 791.3, 785.5, 779.8, 774.2/
data time( 97,1: 8)/ 809.1, 806.5, 803.5, 801.7, 795.9, 790.0, 784.3, 778.7/
data time( 98,1: 8)/ 813.6, 811.1, 808.0, 806.3, 800.4, 794.6, 788.8, 783.2/
data time( 99,1: 8)/ 818.1, 815.6, 812.5, 810.8, 804.9, 799.1, 793.3, 787.7/
data time(100,1: 8)/ 822.6, 820.1, 817.0, 815.3, 809.4, 803.5, 797.8, 792.2/
data time(101,1: 8)/ 827.0, 824.5, 821.5, 819.7, 813.8, 808.0, 802.2, 796.6/
data time(102,1: 8)/ 831.5, 829.0, 825.9, 824.1, 818.3, 812.4, 806.7, 801.1/
data time(  1,9:17)/  38.0,  43.7,  49.3,  54.7,  59.9,  65.0,  70.1,  75.0,  79.7/
data time(  2,9:17)/  40.3,  45.7,  51.0,  56.2,  61.2,  66.2,  71.1,  76.0,  80.6/
data time(  3,9:17)/  46.7,  51.3,  55.9,  60.5,  65.0,  69.6,  74.2,  78.8,  83.1/
data time(  4,9:17)/  55.7,  59.3,  63.2,  67.0,  70.9,  74.9,  79.1,  83.2,  87.2/
data time(  5,9:17)/  66.2,  68.9,  72.0,  75.1,  78.3,  81.8,  85.4,  89.1,  92.6/
data time(  6,9:17)/  77.5,  79.6,  81.9,  84.3,  86.9,  89.8,  92.8,  96.0,  99.0/
data time(  7,9:17)/  89.3,  90.8,  92.6,  94.3,  96.3,  98.5, 101.1, 103.7, 106.2/
data time(  8,9:17)/ 101.3, 102.3, 103.6, 104.7, 106.1, 107.9, 109.9, 112.2, 114.1/
data time(  9,9:17)/ 113.5, 114.1, 114.9, 115.3, 116.3, 117.6, 119.2, 121.0, 122.5/
data time( 10,9:17)/ 125.8, 126.0, 126.4, 126.2, 126.7, 127.7, 128.8, 130.2, 131.2/
data time( 11,9:17)/ 138.1, 137.9, 137.5, 137.1, 137.3, 137.8, 138.7, 139.7, 140.1/
data time( 12,9:17)/ 150.3, 149.8, 148.6, 147.9, 147.9, 148.1, 148.6, 149.3, 149.1/
data time( 13,9:17)/ 162.5, 161.6, 159.6, 158.8, 158.5, 158.4, 158.6, 158.6, 158.2/
data time( 14,9:17)/ 174.6, 172.6, 170.6, 169.6, 169.1, 168.8, 168.7, 167.8, 167.3/
data time( 15,9:17)/ 186.0, 183.6, 181.5, 180.4, 179.6, 179.1, 178.8, 177.0, 176.3/
data time( 16,9:17)/ 197.0, 194.5, 192.4, 191.1, 190.1, 189.4, 188.1, 186.1, 185.4/
data time( 17,9:17)/ 207.9, 205.4, 203.2, 201.7, 200.5, 199.4, 197.2, 195.3, 194.4/
data time( 18,9:17)/ 218.8, 216.2, 213.9, 212.2, 210.9, 208.6, 206.4, 204.4, 203.4/
data time( 19,9:17)/ 229.6, 226.9, 224.4, 222.6, 220.3, 217.8, 215.5, 213.5, 212.4/
data time( 20,9:17)/ 240.2, 237.4, 234.9, 232.1, 229.4, 226.9, 224.6, 222.5, 221.4/
data time( 21,9:17)/ 250.8, 247.9, 244.3, 241.3, 238.5, 236.0, 233.6, 231.5, 230.2/
data time( 22,9:17)/ 260.8, 257.0, 253.5, 250.4, 247.6, 245.0, 242.6, 240.4, 239.1/
data time( 23,9:17)/ 269.9, 266.1, 262.6, 259.5, 256.6, 254.0, 251.5, 249.3, 247.9/
data time( 24,9:17)/ 279.0, 275.2, 271.6, 268.5, 265.6, 262.9, 260.4, 258.2, 256.7/
data time( 25,9:17)/ 288.0, 284.2, 280.6, 277.4, 274.5, 271.8, 269.3, 267.0, 265.5/
data time( 26,9:17)/ 297.0, 293.2, 289.5, 286.3, 283.4, 280.6, 278.1, 275.8, 274.3/
data time( 27,9:17)/ 306.0, 302.1, 298.4, 295.2, 292.2, 289.5, 286.9, 284.5, 282.9/
data time( 28,9:17)/ 314.9, 311.0, 307.3, 304.0, 301.0, 298.2, 295.6, 293.3, 291.6/
data time( 29,9:17)/ 323.7, 319.8, 316.1, 312.8, 309.8, 307.0, 304.4, 301.9, 300.2/
data time( 30,9:17)/ 332.5, 328.6, 324.9, 321.6, 318.5, 315.7, 313.0, 310.5, 308.7/
data time( 31,9:17)/ 341.3, 337.4, 333.6, 330.3, 327.2, 324.3, 321.6, 319.1, 317.2/
data time( 32,9:17)/ 350.1, 346.1, 342.3, 339.0, 335.9, 332.9, 330.1, 327.6, 325.6/
data time( 33,9:17)/ 358.8, 354.8, 351.0, 347.6, 344.4, 341.4, 338.6, 336.0, 334.0/
data time( 34,9:17)/ 367.4, 363.4, 359.5, 356.1, 352.9, 349.9, 347.1, 344.4, 342.3/
data time( 35,9:17)/ 376.0, 372.0, 368.1, 364.6, 361.4, 358.3, 355.4, 352.7, 350.6/
data time( 36,9:17)/ 384.5, 380.4, 376.5, 373.0, 369.8, 366.7, 363.7, 361.0, 358.8/
data time( 37,9:17)/ 393.0, 388.9, 384.9, 381.4, 378.1, 375.0, 372.0, 369.2, 366.9/
data time( 38,9:17)/ 401.4, 397.2, 393.3, 389.7, 386.4, 383.2, 380.2, 377.3, 375.0/
data time( 39,9:17)/ 409.7, 405.5, 401.5, 397.9, 394.6, 391.3, 388.3, 385.4, 383.0/
data time( 40,9:17)/ 418.0, 413.8, 409.8, 406.1, 402.7, 399.4, 396.3, 393.4, 391.0/
data time( 41,9:17)/ 426.2, 422.0, 417.9, 414.2, 410.8, 407.5, 404.3, 401.3, 398.9/
data time( 42,9:17)/ 434.3, 430.0, 426.0, 422.3, 418.8, 415.4, 412.2, 409.2, 406.7/
data time( 43,9:17)/ 442.4, 438.1, 434.0, 430.2, 426.7, 423.3, 420.1, 417.0, 414.5/
data time( 44,9:17)/ 450.4, 446.0, 441.9, 438.1, 434.6, 431.1, 427.9, 424.8, 422.1/
data time( 45,9:17)/ 458.3, 453.9, 449.8, 446.0, 442.4, 438.9, 435.6, 432.4, 429.8/
data time( 46,9:17)/ 466.1, 461.8, 457.5, 453.7, 450.1, 446.6, 443.3, 440.0, 437.3/
data time( 47,9:17)/ 473.9, 469.5, 465.3, 461.4, 457.7, 454.2, 450.8, 447.6, 444.8/
data time( 48,9:17)/ 481.6, 477.2, 472.9, 469.0, 465.3, 461.8, 458.4, 455.1, 452.3/
data time( 49,9:17)/ 489.3, 484.8, 480.5, 476.6, 472.9, 469.3, 465.8, 462.5, 459.6/
data time( 50,9:17)/ 496.9, 492.4, 488.0, 484.1, 480.3, 476.7, 473.2, 469.8, 467.0/
data time( 51,9:17)/ 504.4, 499.8, 495.5, 491.5, 487.7, 484.0, 480.5, 477.1, 474.2/
data time( 52,9:17)/ 511.8, 507.2, 502.9, 498.8, 495.0, 491.3, 487.8, 484.3, 481.4/
data time( 53,9:17)/ 519.2, 514.6, 510.2, 506.1, 502.3, 498.5, 494.9, 491.5, 488.5/
data time( 54,9:17)/ 526.4, 521.8, 517.4, 513.3, 509.4, 505.7, 502.0, 498.5, 495.5/
data time( 55,9:17)/ 533.7, 529.0, 524.6, 520.5, 516.5, 512.8, 509.1, 505.6, 502.5/
data time( 56,9:17)/ 540.8, 536.2, 531.7, 527.5, 523.6, 519.8, 516.1, 512.5, 509.4/
data time( 57,9:17)/ 547.9, 543.2, 538.7, 534.5, 530.5, 526.7, 523.0, 519.4, 516.2/
data time( 58,9:17)/ 554.9, 550.2, 545.6, 541.5, 537.4, 533.6, 529.8, 526.2, 523.0/
data time( 59,9:17)/ 561.8, 557.1, 552.5, 548.3, 544.3, 540.4, 536.6, 532.9, 529.7/
data time( 60,9:17)/ 568.7, 563.9, 559.3, 555.1, 551.0, 547.1, 543.3, 539.6, 536.3/
data time( 61,9:17)/ 575.5, 570.7, 566.1, 561.8, 557.7, 553.8, 549.9, 546.2, 542.9/
data time( 62,9:17)/ 582.2, 577.4, 572.8, 568.5, 564.3, 560.3, 556.5, 552.7, 549.4/
data time( 63,9:17)/ 588.8, 584.0, 579.3, 575.0, 570.9, 566.9, 563.0, 559.2, 555.8/
data time( 64,9:17)/ 595.4, 590.6, 585.9, 581.5, 577.4, 573.3, 569.4, 565.6, 562.2/
data time( 65,9:17)/ 601.9, 597.0, 592.3, 588.0, 583.8, 579.7, 575.8, 571.9, 568.5/
data time( 66,9:17)/ 608.3, 603.5, 598.7, 594.3, 590.1, 586.0, 582.0, 578.2, 574.7/
data time( 67,9:17)/ 614.7, 609.8, 605.1, 600.6, 596.4, 592.3, 588.3, 584.4, 580.9/
data time( 68,9:17)/ 621.0, 616.1, 611.3, 606.9, 602.6, 598.5, 594.4, 590.5, 587.0/
data time( 69,9:17)/ 627.2, 622.3, 617.5, 613.0, 608.7, 604.6, 600.5, 596.6, 593.0/
data time( 70,9:17)/ 633.4, 628.4, 623.6, 619.1, 614.8, 610.6, 606.5, 602.6, 599.0/
data time( 71,9:17)/ 639.4, 634.5, 629.7, 625.1, 620.8, 616.6, 612.5, 608.5, 604.9/
data time( 72,9:17)/ 645.5, 640.5, 635.6, 631.1, 626.7, 622.5, 618.3, 614.3, 610.7/
data time( 73,9:17)/ 651.4, 646.4, 641.5, 637.0, 632.6, 628.3, 624.2, 620.1, 616.4/
data time( 74,9:17)/ 657.3, 652.2, 647.3, 642.8, 638.4, 634.1, 629.9, 625.8, 622.1/
data time( 75,9:17)/ 663.0, 658.0, 653.1, 648.5, 644.1, 639.8, 635.5, 631.5, 627.7/
data time( 76,9:17)/ 668.8, 663.7, 658.8, 654.2, 649.7, 645.4, 641.2, 637.0, 633.3/
data time( 77,9:17)/ 674.4, 669.3, 664.4, 659.8, 655.3, 650.9, 646.7, 642.5, 638.8/
data time( 78,9:17)/ 680.0, 674.9, 669.9, 665.3, 660.8, 656.4, 652.1, 648.0, 644.2/
data time( 79,9:17)/ 685.5, 680.4, 675.4, 670.7, 666.2, 661.8, 657.5, 653.3, 649.5/
data time( 80,9:17)/ 690.9, 685.8, 680.8, 676.1, 671.6, 667.1, 662.8, 658.6, 654.8/
data time( 81,9:17)/ 696.3, 691.1, 686.1, 681.4, 676.8, 672.4, 668.1, 663.8, 660.0/
data time( 82,9:17)/ 701.6, 696.4, 691.4, 686.6, 682.1, 677.6, 673.2, 669.0, 665.1/
data time( 83,9:17)/ 706.8, 701.6, 696.5, 691.8, 687.2, 682.7, 678.3, 674.0, 670.1/
data time( 84,9:17)/ 711.9, 706.7, 701.6, 696.9, 692.3, 687.7, 683.3, 679.0, 675.1/
data time( 85,9:17)/ 717.0, 711.7, 706.7, 701.9, 697.2, 692.7, 688.3, 684.0, 680.0/
data time( 86,9:17)/ 721.9, 716.7, 711.6, 706.8, 702.1, 697.6, 693.2, 688.8, 684.8/
data time( 87,9:17)/ 726.8, 721.6, 716.5, 711.6, 707.0, 702.4, 697.9, 693.6, 689.5/
data time( 88,9:17)/ 731.7, 726.4, 721.2, 716.4, 711.7, 707.1, 702.6, 698.3, 694.2/
data time( 89,9:17)/ 736.4, 731.1, 725.9, 721.1, 716.4, 711.8, 707.3, 702.9, 698.9/
data time( 90,9:17)/ 741.0, 735.8, 730.6, 725.8, 721.0, 716.4, 712.0, 707.6, 703.5/
data time( 91,9:17)/ 745.7, 740.4, 735.3, 730.4, 725.7, 721.1, 716.6, 712.2, 708.1/
data time( 92,9:17)/ 750.3, 745.0, 739.9, 735.0, 730.3, 725.7, 721.2, 716.8, 712.7/
data time( 93,9:17)/ 755.0, 749.7, 744.5, 739.6, 734.9, 730.3, 725.8, 721.4, 717.3/
data time( 94,9:17)/ 759.6, 754.3, 749.1, 744.2, 739.5, 734.9, 730.4, 726.0, 721.9/
data time( 95,9:17)/ 764.2, 758.8, 753.7, 748.8, 744.1, 739.4, 734.9, 730.5, 726.4/
data time( 96,9:17)/ 768.7, 763.4, 758.2, 753.3, 748.6, 744.0, 739.5, 735.0, 731.0/
data time( 97,9:17)/ 773.3, 767.9, 762.8, 757.9, 753.1, 748.5, 744.0, 739.5, 735.4/
data time( 98,9:17)/ 777.8, 772.4, 767.3, 762.3, 757.6, 753.0, 748.4, 744.0, 739.9/
data time( 99,9:17)/ 782.3, 776.9, 771.7, 766.8, 762.1, 757.4, 752.9, 748.4, 744.3/
data time(100,9:17)/ 786.7, 781.4, 776.2, 771.3, 766.5, 761.9, 757.3, 752.9, 748.8/
data time(101,9:17)/ 791.2, 785.8, 780.6, 775.7, 771.0, 766.3, 761.8, 757.3, 753.2/
data time(102,9:17)/ 795.6, 790.3, 785.1, 780.2, 775.4, 770.8, 766.2, 761.8, 757.7/

Ptime=-12345.
if(jdebug>0) write(13,*) 'Ptime dist=',dist,' dmin,dmax=',dmin,dmax
if(dist<dmin .or. dist> dmax) return
if(jdebug>0) write(13,*) 'dep=',dep
if(dep<0. .or. dep> 700.) return

i0=max(1.01,dist-dmin+1)
i0=min(101,i0)
d0=dmin+(i0-1)
i1=i0+1
j1=2
do while (depth(j1)<dep)
  j1=j1+1
enddo
j0=j1-1
if(jdebug>0) then
  write(13,*) 'i0,j0,i1,j1=',i0,j0,i1,j1
  write(13,*) 'i0,j0=',i0,j0,' d0,x,y=',d0,x,y
  write(13,*) 'times:',time(i0,j0),time(i1,j0),time(i0,j1),time(i1,j1)
endif
if(abs(time(i0,j0)) < -0.00001) return
if(abs(time(i0,j1)) < 0.0) return
if(abs(time(i1,j0)) < 0.0) return
if(abs(time(i1,j1)) < 0.0) return
x=(dist-d0)
y=(dep-depth(j0))/(depth(j1)-depth(j0))
t0=time(i0,j0)+x*(time(i1,j0)-time(i0,j0))
t1=time(i0,j1)+x*(time(i1,j1)-time(i0,j1))
Ptime=t0+y*(t1-t0)
if(jdebug>0) then
  write(13,*) 'P dep,dist:',dep,dist,'depth(j0)=',depth(j0),' t=',Ptime
  write(13,*) 'min, sec:',int(time(i0,j0)/60.),time(i0,j0)-  &
    int(time(i0,j0)/60.)*60.
endif

return
end function



real*4 function PKPabtime(dist,dep)

! computes travel time of PKPab wave, 143<dist<178 deg, 0<dep<700
! returns -12345. if dist or dep outside range

implicit none
integer :: i0,i1,j0,j1
real*4 :: d0,t0,t1,x,y
real*4 :: dist,dep     ! distance and depth of the earthquake
real*4 :: dmin,dmax,time(36,8),depth(8)
data dmin,dmax /  143.,  178./
data depth /   0.,  35.,  50., 100., 200., 300., 500., 700./
data time(  1,1: 8)/   0.0,   0.0,   0.0,   0.0,   0.0,   0.0,   0.0,1095.4/
data time(  2,1: 8)/   0.0,   0.0,   0.0,   0.0,   0.0,   0.0,1117.5,1099.1/
data time(  3,1: 8)/1178.5,1172.8,1171.0,1165.0,1153.2,1141.9,1121.3,1103.0/
data time(  4,1: 8)/1182.2,1176.5,1174.8,1168.8,1157.0,1145.8,1125.2,1107.0/
data time(  5,1: 8)/1186.0,1180.4,1178.6,1172.7,1160.9,1149.7,1129.2,1111.1/
data time(  6,1: 8)/1190.0,1184.4,1182.6,1176.6,1164.9,1153.7,1133.2,1115.2/
data time(  7,1: 8)/1194.0,1188.4,1186.6,1180.7,1169.0,1157.8,1137.3,1119.3/
data time(  8,1: 8)/1198.1,1192.5,1190.7,1184.8,1173.1,1161.9,1141.5,1123.5/
data time(  9,1: 8)/1202.2,1196.6,1194.8,1188.9,1177.3,1166.1,1145.7,1127.7/
data time( 10,1: 8)/1206.4,1200.8,1199.0,1193.1,1181.4,1170.3,1149.9,1132.0/
data time( 11,1: 8)/1210.6,1205.0,1203.2,1197.3,1185.7,1174.5,1154.2,1136.3/
data time( 12,1: 8)/1214.8,1209.2,1207.4,1201.5,1189.9,1178.8,1158.4,1140.6/
data time( 13,1: 8)/1219.1,1213.5,1211.7,1205.8,1194.2,1183.0,1162.7,1144.9/
data time( 14,1: 8)/1223.4,1217.8,1216.0,1210.1,1198.5,1187.3,1167.0,1149.2/
data time( 15,1: 8)/1227.7,1222.1,1220.3,1214.4,1202.8,1191.6,1171.4,1153.5/
data time( 16,1: 8)/1232.0,1226.4,1224.6,1218.7,1207.1,1196.0,1175.7,1157.9/
data time( 17,1: 8)/1236.3,1230.7,1228.9,1223.1,1211.4,1200.3,1180.1,1162.3/
data time( 18,1: 8)/1240.7,1235.1,1233.3,1227.4,1215.8,1204.7,1184.4,1166.7/
data time( 19,1: 8)/1245.0,1239.4,1237.7,1231.8,1220.2,1209.1,1188.8,1171.0/
data time( 20,1: 8)/1249.4,1243.8,1242.0,1236.2,1224.6,1213.4,1193.2,1175.4/
data time( 21,1: 8)/1253.8,1248.2,1246.4,1240.5,1228.9,1217.8,1197.6,1179.8/
data time( 22,1: 8)/1258.2,1252.6,1250.8,1244.9,1233.3,1222.2,1202.0,1184.3/
data time( 23,1: 8)/1262.6,1257.0,1255.2,1249.3,1237.7,1226.6,1206.4,1188.7/
data time( 24,1: 8)/1267.0,1261.4,1259.6,1253.8,1242.2,1231.1,1210.8,1193.1/
data time( 25,1: 8)/1271.4,1265.8,1264.0,1258.2,1246.6,1235.5,1215.3,1197.5/
data time( 26,1: 8)/1275.8,1270.2,1268.5,1262.6,1251.0,1239.9,1219.7,1202.0/
data time( 27,1: 8)/1280.2,1274.7,1272.9,1267.0,1255.4,1244.3,1224.1,1206.4/
data time( 28,1: 8)/1284.7,1279.1,1277.3,1271.4,1259.8,1248.8,1228.6,1210.8/
data time( 29,1: 8)/1289.1,1283.5,1281.8,1275.9,1264.3,1253.2,1233.0,1215.3/
data time( 30,1: 8)/1293.5,1288.0,1286.2,1280.3,1268.7,1257.6,1237.4,1219.7/
data time( 31,1: 8)/1298.0,1292.4,1290.6,1284.8,1273.2,1262.1,1241.9,1224.2/
data time( 32,1: 8)/1302.4,1296.8,1295.1,1289.2,1277.6,1266.5,1246.3,1228.6/
data time( 33,1: 8)/1306.9,1301.3,1299.5,1293.6,1282.1,1271.0,1250.8,1233.1/
data time( 34,1: 8)/1311.3,1305.7,1304.0,1298.1,1286.5,1275.4,1255.2,   0.0/
data time( 35,1: 8)/1315.8,1310.2,1308.4,1302.5,1290.9,1279.9,   0.0,   0.0/
data time( 36,1: 8)/1320.2,1314.6,1312.8,   0.0,   0.0,   0.0,   0.0,   0.0/

PKPabtime=-12345.
if(dist<dmin .or. dist> dmax) return
if(dep<0. .or. dep> 700.) return

i0=min(35.,dist-dmin+1)
d0=dmin+(i0-1)
i1=i0+1
j1=2
do while (depth(j1)<dep)
  j1=j1+1
enddo
j0=j1-1
if(time(i0,j0).le.0.) return
if(time(i0,j1).le.0.) return
if(time(i1,j0).le.0.) return
if(time(i1,j1).le.0.) return
x=(dist-d0)
y=(dep-depth(j0))/(depth(j1)-depth(j0))
t0=time(i0,j0)+x*(time(i1,j0)-time(i0,j0))
t1=time(i0,j1)+x*(time(i1,j1)-time(i0,j1))
PKPabtime=t0+y*(t1-t0)
!write(13,*) 'PKPab dep,dist:',dep,dist,'depth(j0)=',depth(j0),' t=',PKPabtime
!write(13,*) 'i0,j0=',i0,j0,' d0,x,y=',d0,x,y
!write(13,*) 'times:',time(i0,j0),time(i1,j0),time(i0,j1),time(i1,j1)
!write(13,*) 'min, sec:',int(time(i0,j0)/60.),time(i0,j0)-int(time(i0,j0)/60.)*60.

return
end function

real*4 function PKPbctime(dist,dep)

! computes travel time of PKPbc wave, 143<dist<155 deg, 0<dep<700
! returns -12345. if dist or dep outside range

implicit none
integer :: i0,i1,j0,j1
real*4 :: d0,t0,t1,x,y
real*4 :: dist,dep     ! distance and depth of the earthquake
real*4 :: dmin,dmax,time(13,8),depth(8)
data dmin,dmax /  143.,  155./
data depth /   0.,  35.,  50., 100., 200., 300., 500., 700./
data time(  1,1: 8)/   0.0,   0.0,   0.0,   0.0,   0.0,   0.0,   0.0,1095.4/
data time(  2,1: 8)/   0.0,   0.0,   0.0,   0.0,   0.0,   0.0,1117.3,1098.6/
data time(  3,1: 8)/1178.5,1172.8,1171.0,1165.0,1153.1,1141.6,1120.5,1101.5/
data time(  4,1: 8)/1181.7,1176.0,1174.2,1168.1,1156.1,1144.6,1123.4,1104.3/
data time(  5,1: 8)/1184.6,1178.9,1177.1,1171.0,1159.0,1147.4,1126.1,1107.0/
data time(  6,1: 8)/1187.3,1181.6,1179.8,1173.7,1161.7,1150.1,1128.7,1109.5/
data time(  7,1: 8)/1189.9,1184.2,1182.4,1176.3,1164.2,1152.6,1131.2,1112.0/
data time(  8,1: 8)/1192.4,1186.7,1184.9,1178.7,1166.7,1155.0,1133.6,1114.3/
data time(  9,1: 8)/1194.8,1189.1,1187.2,1181.1,1169.0,1157.4,1135.9,1116.6/
data time( 10,1: 8)/1197.1,1191.4,1189.5,1183.4,1171.3,1159.6,1138.1,1118.8/
data time( 11,1: 8)/1199.3,1193.6,1191.8,1185.6,1173.5,1161.8,1140.3,1121.0/
data time( 12,1: 8)/1201.5,1195.8,1193.9,1187.8,1175.7,1164.0,1142.4,1123.1/
data time( 13,1: 8)/1203.6,1197.9,1196.1,1189.9,1177.8,1166.1,1142.4,1123.1/


PKPbctime=-12345.
if(dist<dmin .or. dist> dmax) return
if(dep<0. .or. dep> 700.) return

i0=min(12.,dist-dmin+1)
d0=dmin+(i0-1)
i1=i0+1
j1=2
do while (depth(j1)<dep)
  j1=j1+1
enddo
j0=j1-1
if(time(i0,j0).le.0.) return
if(time(i0,j1).le.0.) return
if(time(i1,j0).le.0.) return
if(time(i1,j1).le.0.) return
x=(dist-d0)
y=(dep-depth(j0))/(depth(j1)-depth(j0))
t0=time(i0,j0)+x*(time(i1,j0)-time(i0,j0))
t1=time(i0,j1)+x*(time(i1,j1)-time(i0,j1))
PKPbctime=t0+y*(t1-t0)
!write(13,*) 'PKPbc dep,dist:',dep,dist,'depth(j0)=',depth(j0),' t=',PKPbctime
!write(13,*) 'i0,j0=',i0,j0,' d0,x,y=',d0,x,y
!write(13,*) 'times:',time(i0,j0),time(i1,j0),time(i0,j1),time(i1,j1)
!write(13,*) 'min, sec:',int(time(i0,j0)/60.),time(i0,j0)-int(time(i0,j0)/60.)*60.

return
end function


real*4 function PKPdftime(dist,dep)

! computes travel time of PKPdf wave, 113<dist<180 deg, 0<dep<700
! returns -12345. if dist or dep outside range

implicit none
integer :: i0,i1,j0,j1
real*4 :: d0,t0,t1,x,y
real*4 :: dist,dep     ! distance and depth of the earthquake
real*4 :: dmin,dmax,time(68,8),depth(8)

data dmin,dmax /  113.,  180./
data depth /   0.,  35.,  50., 100., 200., 300., 500., 700./
data time(  1,1: 8)/   0.0,   0.0,   0.0,   0.0,   0.0,   0.0,   0.0,   0.0/
data time(  2,1: 8)/   0.0,   0.0,   0.0,   0.0,   0.0,   0.0,   0.0,   0.0/
data time(  3,1: 8)/   0.0,   0.0,   0.0,   0.0,   0.0,1085.3,1063.7,1044.3/
data time(  4,1: 8)/1124.8,1119.1,1117.3,1111.1,1098.9,1087.3,1065.6,1046.2/
data time(  5,1: 8)/1126.8,1121.0,1119.2,1113.0,1100.9,1089.2,1067.6,1048.1/
data time(  6,1: 8)/1128.7,1123.0,1121.1,1115.0,1102.8,1091.1,1069.5,1050.1/
data time(  7,1: 8)/1130.6,1124.9,1123.0,1116.9,1104.7,1093.0,1071.4,1052.0/
data time(  8,1: 8)/1132.5,1126.8,1125.0,1118.8,1106.7,1094.9,1073.3,1053.9/
data time(  9,1: 8)/1134.4,1128.7,1126.9,1120.7,1108.6,1096.9,1075.3,1055.8/
data time( 10,1: 8)/1136.4,1130.7,1128.8,1122.7,1110.5,1098.8,1077.2,1057.7/
data time( 11,1: 8)/1138.3,1132.6,1130.7,1124.6,1112.4,1100.7,1079.1,1059.7/
data time( 12,1: 8)/1140.2,1134.5,1132.6,1126.5,1114.3,1102.6,1081.0,1061.6/
data time( 13,1: 8)/1142.1,1136.4,1134.6,1128.4,1116.2,1104.5,1082.9,1063.5/
data time( 14,1: 8)/1144.0,1138.3,1136.5,1130.3,1118.2,1106.4,1084.8,1065.4/
data time( 15,1: 8)/1145.9,1140.2,1138.4,1132.2,1120.1,1108.4,1086.7,1067.3/
data time( 16,1: 8)/1147.9,1142.1,1140.3,1134.1,1122.0,1110.3,1088.7,1069.2/
data time( 17,1: 8)/1149.8,1144.0,1142.2,1136.0,1123.9,1112.2,1090.6,1071.1/
data time( 18,1: 8)/1151.7,1145.9,1144.1,1137.9,1125.8,1114.1,1092.4,1073.0/
data time( 19,1: 8)/1153.6,1147.8,1146.0,1139.8,1127.7,1116.0,1094.3,1074.9/
data time( 20,1: 8)/1155.4,1149.7,1147.9,1141.7,1129.6,1117.8,1096.2,1076.8/
data time( 21,1: 8)/1157.3,1151.6,1149.8,1143.6,1131.4,1119.7,1098.1,1078.7/
data time( 22,1: 8)/1159.2,1153.5,1151.7,1145.5,1133.3,1121.6,1100.0,1080.5/
data time( 23,1: 8)/1161.1,1155.4,1153.5,1147.4,1135.2,1123.5,1101.8,1082.4/
data time( 24,1: 8)/1163.0,1157.2,1155.4,1149.2,1137.1,1125.3,1103.7,1084.3/
data time( 25,1: 8)/1164.8,1159.1,1157.2,1151.1,1138.9,1127.2,1105.6,1086.1/
data time( 26,1: 8)/1166.7,1160.9,1159.1,1152.9,1140.8,1129.0,1107.4,1087.9/
data time( 27,1: 8)/1168.5,1162.8,1160.9,1154.8,1142.6,1130.9,1109.2,1089.8/
data time( 28,1: 8)/1170.3,1164.6,1162.7,1156.6,1144.4,1132.7,1111.0,1091.6/
data time( 29,1: 8)/1172.1,1166.4,1164.5,1158.4,1146.2,1134.5,1112.8,1093.3/
data time( 30,1: 8)/1173.9,1168.2,1166.3,1160.2,1148.0,1136.3,1114.6,1095.1/
data time( 31,1: 8)/1175.7,1170.0,1168.1,1161.9,1149.8,1138.0,1116.4,1096.9/
data time( 32,1: 8)/1177.4,1171.7,1169.9,1163.7,1151.5,1139.8,1118.1,1098.6/
data time( 33,1: 8)/1179.2,1173.5,1171.6,1165.4,1153.3,1141.5,1119.8,1100.3/
data time( 34,1: 8)/1180.9,1175.2,1173.3,1167.2,1155.0,1143.2,1121.6,1102.0/
data time( 35,1: 8)/1182.6,1176.9,1175.0,1168.8,1156.7,1144.9,1123.2,1103.7/
data time( 36,1: 8)/1184.3,1178.5,1176.7,1170.5,1158.3,1146.6,1124.9,1105.3/
data time( 37,1: 8)/1185.9,1180.2,1178.3,1172.1,1159.9,1148.2,1126.5,1106.9/
data time( 38,1: 8)/1187.5,1181.7,1179.9,1173.7,1161.5,1149.8,1128.1,1108.5/
data time( 39,1: 8)/1189.0,1183.3,1181.4,1175.3,1163.1,1151.3,1129.6,1110.0/
data time( 40,1: 8)/1190.6,1184.8,1183.0,1176.8,1164.6,1152.8,1131.1,1111.5/
data time( 41,1: 8)/1192.0,1186.3,1184.4,1178.3,1166.0,1154.3,1132.5,1112.9/
data time( 42,1: 8)/1193.5,1187.7,1185.9,1179.7,1167.5,1155.7,1133.9,1114.3/
data time( 43,1: 8)/1194.9,1189.1,1187.3,1181.1,1168.8,1157.1,1135.3,1115.7/
data time( 44,1: 8)/1196.2,1190.5,1188.6,1182.4,1170.2,1158.4,1136.6,1117.0/
data time( 45,1: 8)/1197.5,1191.8,1189.9,1183.7,1171.5,1159.7,1137.9,1118.3/
data time( 46,1: 8)/1198.8,1193.0,1191.2,1185.0,1172.7,1160.9,1139.1,1119.5/
data time( 47,1: 8)/1200.0,1194.2,1192.3,1186.2,1173.9,1162.1,1140.3,1120.6/
data time( 48,1: 8)/1201.1,1195.4,1193.5,1187.3,1175.1,1163.3,1141.4,1121.8/
data time( 49,1: 8)/1202.2,1196.5,1194.6,1188.4,1176.2,1164.3,1142.5,1122.8/
data time( 50,1: 8)/1203.3,1197.5,1195.6,1189.4,1177.2,1165.4,1143.6,1123.8/
data time( 51,1: 8)/1204.2,1198.5,1196.6,1190.4,1178.2,1166.4,1144.5,1124.8/
data time( 52,1: 8)/1205.2,1199.4,1197.6,1191.4,1179.1,1167.3,1145.4,1125.7/
data time( 53,1: 8)/1206.1,1200.3,1198.4,1192.3,1180.0,1168.2,1146.3,1126.6/
data time( 54,1: 8)/1206.9,1201.1,1199.3,1193.1,1180.8,1169.0,1147.1,1127.4/
data time( 55,1: 8)/1207.7,1201.9,1200.1,1193.8,1181.6,1169.8,1147.9,1128.1/
data time( 56,1: 8)/1208.4,1202.6,1200.8,1194.6,1182.3,1170.5,1148.6,1128.8/
data time( 57,1: 8)/1209.0,1203.3,1201.4,1195.2,1182.9,1171.1,1149.2,1129.5/
data time( 58,1: 8)/1209.6,1203.9,1202.0,1195.8,1183.5,1171.7,1149.8,1130.0/
data time( 59,1: 8)/1210.2,1204.4,1202.6,1196.4,1184.1,1172.3,1150.3,1130.6/
data time( 60,1: 8)/1210.7,1204.9,1203.1,1196.8,1184.6,1172.7,1150.8,1131.0/
data time( 61,1: 8)/1211.1,1205.4,1203.5,1197.3,1185.0,1173.2,1151.3,1131.5/
data time( 62,1: 8)/1211.5,1205.7,1203.9,1197.7,1185.4,1173.5,1151.6,1131.8/
data time( 63,1: 8)/1211.8,1206.1,1204.2,1198.0,1185.7,1173.8,1151.9,1132.1/
data time( 64,1: 8)/1212.1,1206.3,1204.4,1198.2,1185.9,1174.1,1152.2,1132.4/
data time( 65,1: 8)/1212.3,1206.5,1204.7,1198.4,1186.1,1174.3,1152.4,1132.6/
data time( 66,1: 8)/1212.4,1206.7,1204.8,1198.6,1186.3,1174.4,1152.5,1132.7/
data time( 67,1: 8)/1212.5,1206.7,1204.9,1198.7,1186.4,1174.5,1152.6,1132.8/
data time( 68,1: 8)/1212.5,1206.8,1204.9,1198.7,1186.4,1174.6,1152.6,1132.8/


PKPdftime=-12345.
if(dist<dmin .or. dist> dmax) return
if(dep<0. .or. dep> 700.) return

i0=min(67.,dist-dmin+1)
d0=dmin+(i0-1)
i1=i0+1
j1=2
do while (depth(j1)<dep)
  j1=j1+1
enddo
j0=j1-1
if(time(i0,j0).le.0.) return
if(time(i0,j1).le.0.) return
if(time(i1,j0).le.0.) return
if(time(i1,j1).le.0.) return
x=(dist-d0)
y=(dep-depth(j0))/(depth(j1)-depth(j0))
t0=time(i0,j0)+x*(time(i1,j0)-time(i0,j0))
t1=time(i0,j1)+x*(time(i1,j1)-time(i0,j1))
PKPdftime=t0+y*(t1-t0)
!write(13,*) 'PKPdf dep,dist:',dep,dist,'depth(j0)=',depth(j0),'t=',PKPdftime
!write(13,*) 'i0,j0=',i0,j0,' d0,x,y=',d0,x,y
!write(13,*) 'times:',time(i0,j0),time(i1,j0),time(i0,j1),time(i1,j1)
!write(13,*) 'min, sec:',int(time(i0,j0)/60.),time(i0,j0)-int(time(i0,j0)/60.)*60.

return
end function


real*4 function Stime(dist,dep)

! computes travel time of S wave, 0<dist<101 deg, 0<dep<700
! returns -12345. if dist or dep outside range

implicit none
integer :: i0,i1,j0,j1
real*4 :: d0,t0,t1,x,y
real*4 :: dist,dep     ! distance and depth of the earthquake
real*4 :: dmin,dmax,time(102,17),depth(17)

data dmin,dmax /    0.,  101./
data depth /   0.,  15.,  35.,  50., 100., 150., 200., 250.,   &
  300., 350., 400., 450., 500., 550., 600., 650., 700./
data time(  1,1: 8)/   0.0,   4.3,   9.7,  13.0,  24.2,  35.3,  46.3,  57.3/
data time(  2,1: 8)/  32.1,  32.0,  30.4,  30.7,  35.7,  43.6,  52.8,  62.5/
data time(  3,1: 8)/  60.8,  58.0,  55.1,  55.1,  57.4,  62.0,  68.4,  75.9/
data time(  4,1: 8)/  85.4,  82.7,  79.7,  79.7,  80.9,  83.9,  88.4,  93.9/
data time(  5,1: 8)/ 110.1, 107.3, 104.4, 104.3, 105.0, 107.0, 110.2, 114.4/
data time(  6,1: 8)/ 134.8, 132.0, 129.1, 128.9, 129.2, 130.6, 133.0, 136.1/
data time(  7,1: 8)/ 159.4, 156.6, 153.7, 153.5, 153.5, 154.4, 156.2, 158.5/
data time(  8,1: 8)/ 184.0, 181.3, 178.3, 178.1, 177.9, 178.4, 179.7, 181.4/
data time(  9,1: 8)/ 208.6, 205.9, 202.9, 202.7, 202.2, 202.4, 203.3, 204.4/
data time( 10,1: 8)/ 233.2, 230.4, 227.5, 227.2, 226.6, 226.5, 227.1, 227.7/
data time( 11,1: 8)/ 257.8, 255.0, 252.1, 251.7, 250.9, 250.6, 250.9, 250.9/
data time( 12,1: 8)/ 282.3, 279.5, 276.6, 276.2, 275.2, 274.7, 274.7, 274.2/
data time( 13,1: 8)/ 306.8, 304.0, 301.0, 300.6, 299.5, 298.8, 298.6, 297.3/
data time( 14,1: 8)/ 331.3, 328.5, 325.5, 325.0, 323.7, 322.9, 322.4, 320.3/
data time( 15,1: 8)/ 355.7, 352.9, 349.9, 349.4, 347.9, 346.9, 345.7, 343.0/
data time( 16,1: 8)/ 380.1, 377.3, 374.2, 373.7, 372.1, 370.9, 368.7, 365.6/
data time( 17,1: 8)/ 404.4, 401.6, 398.5, 398.0, 396.3, 394.8, 391.4, 385.8/
data time( 18,1: 8)/ 428.7, 425.9, 422.8, 422.2, 420.3, 417.7, 411.7, 405.9/
data time( 19,1: 8)/ 452.9, 450.1, 447.0, 446.4, 444.0, 437.8, 431.7, 425.7/
data time( 20,1: 8)/ 477.1, 474.2, 471.2, 470.5, 464.1, 457.8, 451.5, 445.4/
data time( 21,1: 8)/ 499.8, 496.4, 492.4, 490.5, 483.9, 477.5, 471.0, 464.7/
data time( 22,1: 8)/ 519.7, 516.2, 512.3, 510.3, 503.6, 496.9, 489.9, 482.0/
data time( 23,1: 8)/ 539.3, 535.8, 531.8, 529.8, 522.6, 514.4, 506.2, 498.3/
data time( 24,1: 8)/ 557.9, 554.2, 549.7, 547.2, 538.9, 530.6, 522.4, 514.4/
data time( 25,1: 8)/ 574.1, 570.4, 565.9, 563.4, 555.0, 546.7, 538.4, 530.3/
data time( 26,1: 8)/ 590.3, 586.5, 582.0, 579.5, 571.0, 562.6, 554.2, 546.1/
data time( 27,1: 8)/ 606.1, 602.4, 597.8, 595.3, 586.8, 578.3, 570.0, 561.8/
data time( 28,1: 8)/ 621.9, 618.2, 613.6, 611.1, 602.5, 594.1, 585.8, 577.6/
data time( 29,1: 8)/ 637.7, 633.9, 629.4, 626.8, 618.3, 609.8, 601.5, 593.3/
data time( 30,1: 8)/ 653.4, 649.7, 645.1, 642.5, 634.0, 625.5, 617.2, 609.0/
data time( 31,1: 8)/ 669.1, 665.4, 660.8, 658.3, 649.7, 641.2, 632.8, 624.6/
data time( 32,1: 8)/ 684.8, 681.0, 676.5, 673.9, 665.3, 656.8, 648.4, 640.2/
data time( 33,1: 8)/ 700.5, 696.7, 692.1, 689.5, 680.9, 672.4, 664.0, 655.7/
data time( 34,1: 8)/ 716.0, 712.2, 707.7, 705.1, 696.5, 687.9, 679.5, 671.1/
data time( 35,1: 8)/ 731.5, 727.7, 723.2, 720.6, 711.9, 703.4, 694.9, 686.5/
data time( 36,1: 8)/ 747.0, 743.2, 738.6, 736.0, 727.3, 718.7, 710.2, 701.8/
data time( 37,1: 8)/ 762.3, 758.5, 754.0, 751.3, 742.6, 734.0, 725.4, 717.0/
data time( 38,1: 8)/ 777.6, 773.8, 769.2, 766.6, 757.8, 749.2, 740.6, 732.2/
data time( 39,1: 8)/ 792.8, 789.0, 784.4, 781.8, 773.0, 764.3, 755.7, 747.2/
data time( 40,1: 8)/ 807.9, 804.1, 799.5, 796.8, 788.0, 779.3, 770.7, 762.1/
data time( 41,1: 8)/ 822.9, 819.1, 814.5, 811.8, 803.0, 794.2, 785.5, 777.0/
data time( 42,1: 8)/ 837.9, 834.0, 829.4, 826.7, 817.9, 809.1, 800.3, 791.8/
data time( 43,1: 8)/ 852.7, 848.8, 844.2, 841.5, 832.6, 823.8, 815.0, 806.4/
data time( 44,1: 8)/ 867.4, 863.6, 858.9, 856.2, 847.3, 838.5, 829.7, 821.0/
data time( 45,1: 8)/ 882.1, 878.2, 873.6, 870.9, 861.9, 853.0, 844.2, 835.5/
data time( 46,1: 8)/ 896.6, 892.7, 888.1, 885.4, 876.4, 867.5, 858.6, 849.8/
data time( 47,1: 8)/ 911.0, 907.2, 902.5, 899.8, 890.8, 881.8, 872.9, 864.1/
data time( 48,1: 8)/ 925.4, 921.5, 916.8, 914.1, 905.0, 896.0, 887.1, 878.3/
data time( 49,1: 8)/ 939.6, 935.7, 931.0, 928.3, 919.2, 910.2, 901.2, 892.3/
data time( 50,1: 8)/ 953.7, 949.8, 945.1, 942.4, 933.3, 924.2, 915.2, 906.3/
data time( 51,1: 8)/ 967.7, 963.8, 959.1, 956.4, 947.2, 938.1, 929.0, 920.1/
data time( 52,1: 8)/ 981.6, 977.7, 973.0, 970.2, 961.0, 951.9, 942.8, 933.9/
data time( 53,1: 8)/ 995.4, 991.5, 986.8, 984.0, 974.8, 965.6, 956.5, 947.5/
data time( 54,1: 8)/1009.1,1005.2,1000.5, 997.7, 988.4, 979.2, 970.0, 961.0/
data time( 55,1: 8)/1022.7,1018.8,1014.0,1011.2,1001.9, 992.7, 983.5, 974.5/
data time( 56,1: 8)/1036.2,1032.2,1027.5,1024.7,1015.3,1006.1, 996.8, 987.8/
data time( 57,1: 8)/1049.5,1045.6,1040.8,1038.0,1028.7,1019.3,1010.1,1001.0/
data time( 58,1: 8)/1062.8,1058.8,1054.1,1051.2,1041.8,1032.5,1023.2,1014.1/
data time( 59,1: 8)/1075.9,1072.0,1067.2,1064.3,1054.9,1045.6,1036.2,1027.1/
data time( 60,1: 8)/1089.0,1085.0,1080.2,1077.3,1067.9,1058.5,1049.2,1039.9/
data time( 61,1: 8)/1101.9,1097.9,1093.1,1090.3,1080.8,1071.3,1061.9,1052.7/
data time( 62,1: 8)/1114.7,1110.7,1105.9,1103.0,1093.5,1084.1,1074.6,1065.3/
data time( 63,1: 8)/1127.4,1123.4,1118.6,1115.7,1106.2,1096.7,1087.2,1077.9/
data time( 64,1: 8)/1140.0,1136.0,1131.2,1128.3,1118.7,1109.2,1099.7,1090.3/
data time( 65,1: 8)/1152.4,1148.4,1143.6,1140.7,1131.1,1121.5,1112.0,1102.7/
data time( 66,1: 8)/1164.8,1160.8,1155.9,1153.0,1143.4,1133.8,1124.3,1114.9/
data time( 67,1: 8)/1177.1,1173.0,1168.2,1165.3,1155.6,1146.0,1136.4,1126.9/
data time( 68,1: 8)/1189.2,1185.2,1180.3,1177.4,1167.7,1158.0,1148.4,1138.9/
data time( 69,1: 8)/1201.2,1197.2,1192.3,1189.4,1179.6,1169.9,1160.3,1150.8/
data time( 70,1: 8)/1213.1,1209.1,1204.2,1201.2,1191.5,1181.8,1172.1,1162.6/
data time( 71,1: 8)/1224.9,1220.8,1215.9,1213.0,1203.2,1193.5,1183.8,1174.2/
data time( 72,1: 8)/1236.6,1232.5,1227.6,1224.7,1214.8,1205.1,1195.3,1185.8/
data time( 73,1: 8)/1248.1,1244.1,1239.1,1236.2,1226.3,1216.5,1206.8,1197.2/
data time( 74,1: 8)/1259.6,1255.5,1250.6,1247.6,1237.7,1227.9,1218.1,1208.5/
data time( 75,1: 8)/1270.9,1266.8,1261.9,1258.9,1249.0,1239.1,1229.3,1219.6/
data time( 76,1: 8)/1282.1,1278.0,1273.1,1270.1,1260.1,1250.3,1240.4,1230.7/
data time( 77,1: 8)/1293.2,1289.1,1284.1,1281.1,1271.2,1261.3,1251.4,1241.7/
data time( 78,1: 8)/1304.1,1300.0,1295.1,1292.1,1282.1,1272.2,1262.3,1252.5/
data time( 79,1: 8)/1314.9,1310.9,1305.9,1302.9,1292.9,1282.9,1273.0,1263.2/
data time( 80,1: 8)/1325.7,1321.6,1316.6,1313.6,1303.6,1293.6,1283.6,1273.8/
data time( 81,1: 8)/1336.3,1332.2,1327.2,1324.2,1314.1,1304.1,1294.1,1284.3/
data time( 82,1: 8)/1346.8,1342.7,1337.7,1334.6,1324.6,1314.5,1304.5,1294.6/
data time( 83,1: 8)/1357.1,1353.0,1348.0,1345.0,1334.9,1324.8,1314.8,1304.8/
data time( 84,1: 8)/1367.4,1363.3,1358.2,1355.2,1345.1,1334.9,1324.9,1315.0/
data time( 85,1: 8)/1377.5,1373.3,1368.3,1365.3,1355.1,1345.0,1334.9,1324.9/
data time( 86,1: 8)/1387.4,1383.3,1378.3,1375.2,1365.1,1354.9,1344.8,1334.8/
data time( 87,1: 8)/1397.3,1393.2,1388.1,1385.1,1374.9,1364.7,1354.6,1344.5/
data time( 88,1: 8)/1407.0,1402.9,1397.9,1394.8,1384.5,1374.3,1364.2,1354.1/
data time( 89,1: 8)/1416.6,1412.5,1407.4,1404.4,1394.1,1383.9,1373.7,1363.6/
data time( 90,1: 8)/1426.1,1422.0,1416.9,1413.8,1403.5,1393.3,1383.1,1372.9/
data time( 91,1: 8)/1435.4,1431.3,1426.2,1423.1,1412.8,1402.5,1392.3,1382.2/
data time( 92,1: 8)/1444.6,1440.5,1435.4,1432.3,1422.0,1411.7,1401.4,1391.2/
data time( 93,1: 8)/1453.7,1449.6,1444.5,1441.3,1431.0,1420.7,1410.4,1400.2/
data time( 94,1: 8)/1462.6,1458.5,1453.4,1450.3,1439.9,1429.5,1419.2,1409.0/
data time( 95,1: 8)/1471.4,1467.3,1462.2,1459.0,1448.6,1438.3,1427.9,1417.7/
data time( 96,1: 8)/1480.2,1476.0,1470.9,1467.8,1457.3,1447.0,1436.6,1426.4/
data time( 97,1: 8)/1488.8,1484.7,1479.6,1476.4,1466.0,1455.6,1445.3,1435.0/
data time( 98,1: 8)/1497.5,1493.3,1488.2,1485.0,1474.6,1464.2,1453.8,1443.6/
data time( 99,1: 8)/1506.0,1501.8,1496.7,1493.6,1483.1,1472.7,1462.3,1452.1/
data time(100,1: 8)/1514.5,1510.3,1505.2,1502.0,1491.6,1481.1,1470.8,1460.5/
data time(101,1: 8)/1522.9,1518.7,1513.6,1510.4,1499.9,1489.5,1479.1,1468.8/
data time(102,1: 8)/1531.2,1527.0,1521.9,1518.7,1508.3,1497.8,1487.4,1477.2/
data time(  1,9:17)/  68.1,  78.7,  89.1,  99.0, 108.6, 118.0, 127.2, 136.2, 144.6/
data time(  2,9:17)/  72.4,  82.4,  92.3, 101.7, 111.0, 120.1, 129.1, 138.0, 146.3/
data time(  3,9:17)/  84.0,  92.4, 101.1, 109.5, 117.9, 126.3, 134.7, 143.1, 150.9/
data time(  4,9:17)/ 100.2, 107.0, 114.3, 121.4, 128.6, 136.1, 143.6, 151.2, 158.3/
data time(  5,9:17)/ 119.2, 124.6, 130.5, 136.2, 142.2, 148.6, 155.1, 161.8, 168.1/
data time(  6,9:17)/ 139.7, 143.9, 148.6, 153.1, 157.9, 163.1, 168.6, 174.4, 179.8/
data time(  7,9:17)/ 161.2, 164.4, 168.0, 171.3, 175.0, 179.2, 183.7, 188.6, 193.0/
data time(  8,9:17)/ 183.2, 185.5, 188.3, 190.4, 193.1, 196.3, 200.0, 204.0, 207.4/
data time(  9,9:17)/ 205.6, 207.1, 209.1, 210.0, 211.8, 214.2, 217.0, 220.2, 222.6/
data time( 10,9:17)/ 228.1, 229.0, 230.2, 229.9, 230.9, 232.5, 234.6, 237.0, 238.4/
data time( 11,9:17)/ 250.8, 251.0, 250.8, 249.9, 250.2, 251.1, 252.5, 254.3, 254.5/
data time( 12,9:17)/ 273.4, 273.0, 271.2, 269.9, 269.6, 270.0, 270.7, 271.5, 270.8/
data time( 13,9:17)/ 296.0, 295.0, 291.5, 289.8, 289.1, 288.8, 289.0, 288.2, 287.1/
data time( 14,9:17)/ 318.5, 315.6, 311.7, 309.7, 308.5, 307.7, 307.4, 304.8, 303.4/
data time( 15,9:17)/ 340.3, 335.8, 331.8, 329.4, 327.8, 326.6, 325.0, 321.3, 319.6/
data time( 16,9:17)/ 360.5, 355.9, 351.7, 348.9, 346.9, 345.3, 341.5, 337.8, 335.8/
data time( 17,9:17)/ 380.6, 375.8, 371.4, 368.3, 365.9, 362.3, 358.0, 354.1, 351.9/
data time( 18,9:17)/ 400.5, 395.5, 390.8, 387.5, 383.6, 378.8, 374.3, 370.3, 367.8/
data time( 19,9:17)/ 420.1, 415.0, 410.1, 405.3, 400.0, 395.0, 390.5, 386.3, 383.6/
data time( 20,9:17)/ 439.6, 434.2, 427.6, 421.7, 416.3, 411.2, 406.6, 402.2, 399.4/
data time( 21,9:17)/ 458.1, 450.9, 444.0, 437.9, 432.4, 427.3, 422.4, 418.0, 415.1/
data time( 22,9:17)/ 474.4, 467.1, 460.1, 454.0, 448.4, 443.1, 438.2, 433.7, 430.9/
data time( 23,9:17)/ 490.6, 483.2, 476.2, 469.9, 464.2, 458.9, 454.0, 449.5, 446.6/
data time( 24,9:17)/ 506.6, 499.1, 492.0, 485.7, 480.0, 474.6, 469.7, 465.2, 462.2/
data time( 25,9:17)/ 522.4, 515.0, 507.8, 501.5, 495.7, 490.4, 485.4, 480.9, 477.9/
data time( 26,9:17)/ 538.2, 530.7, 523.5, 517.2, 511.4, 506.0, 501.1, 496.5, 493.4/
data time( 27,9:17)/ 554.0, 546.5, 539.3, 532.9, 527.1, 521.7, 516.7, 512.1, 509.0/
data time( 28,9:17)/ 569.7, 562.2, 555.0, 548.6, 542.8, 537.3, 532.3, 527.6, 524.4/
data time( 29,9:17)/ 585.4, 577.8, 570.6, 564.3, 558.4, 552.9, 547.8, 543.1, 539.8/
data time( 30,9:17)/ 601.1, 593.5, 586.3, 579.8, 574.0, 568.4, 563.3, 558.5, 555.1/
data time( 31,9:17)/ 616.7, 609.1, 601.8, 595.4, 589.4, 583.8, 578.7, 573.8, 570.3/
data time( 32,9:17)/ 632.2, 624.6, 617.3, 610.8, 604.8, 599.2, 594.0, 589.1, 585.5/
data time( 33,9:17)/ 647.7, 640.1, 632.7, 626.2, 620.2, 614.5, 609.2, 604.2, 600.6/
data time( 34,9:17)/ 663.1, 655.5, 648.1, 641.5, 635.4, 629.7, 624.3, 619.3, 615.6/
data time( 35,9:17)/ 678.5, 670.8, 663.3, 656.7, 650.6, 644.8, 639.4, 634.3, 630.5/
data time( 36,9:17)/ 693.7, 686.0, 678.5, 671.9, 665.7, 659.9, 654.4, 649.3, 645.3/
data time( 37,9:17)/ 708.9, 701.1, 693.6, 686.9, 680.7, 674.8, 669.3, 664.1, 660.1/
data time( 38,9:17)/ 724.0, 716.2, 708.6, 701.9, 695.6, 689.7, 684.1, 678.8, 674.7/
data time( 39,9:17)/ 739.0, 731.1, 723.6, 716.8, 710.5, 704.5, 698.8, 693.5, 689.3/
data time( 40,9:17)/ 753.9, 746.0, 738.4, 731.6, 725.2, 719.1, 713.4, 708.0, 703.8/
data time( 41,9:17)/ 768.8, 760.8, 753.1, 746.3, 739.8, 733.7, 728.0, 722.5, 718.2/
data time( 42,9:17)/ 783.5, 775.5, 767.8, 760.9, 754.4, 748.2, 742.4, 736.9, 732.5/
data time( 43,9:17)/ 798.1, 790.1, 782.3, 775.4, 768.8, 762.6, 756.7, 751.2, 746.7/
data time( 44,9:17)/ 812.7, 804.6, 796.8, 789.8, 783.2, 776.9, 771.0, 765.3, 760.8/
data time( 45,9:17)/ 827.1, 819.0, 811.1, 804.1, 797.4, 791.1, 785.1, 779.4, 774.8/
data time( 46,9:17)/ 841.4, 833.3, 825.4, 818.3, 811.6, 805.2, 799.1, 793.4, 788.7/
data time( 47,9:17)/ 855.6, 847.5, 839.5, 832.4, 825.6, 819.2, 813.1, 807.3, 802.5/
data time( 48,9:17)/ 869.8, 861.5, 853.6, 846.4, 839.6, 833.1, 826.9, 821.0, 816.2/
data time( 49,9:17)/ 883.8, 875.5, 867.5, 860.3, 853.4, 846.9, 840.6, 834.7, 829.8/
data time( 50,9:17)/ 897.7, 889.4, 881.3, 874.0, 867.2, 860.6, 854.3, 848.3, 843.3/
data time( 51,9:17)/ 911.5, 903.2, 895.1, 887.7, 880.8, 874.1, 867.8, 861.8, 856.7/
data time( 52,9:17)/ 925.2, 916.8, 908.7, 901.3, 894.3, 887.6, 881.2, 875.1, 870.0/
data time( 53,9:17)/ 938.8, 930.4, 922.2, 914.8, 907.7, 901.0, 894.5, 888.4, 883.2/
data time( 54,9:17)/ 952.3, 943.8, 935.6, 928.1, 921.1, 914.3, 907.8, 901.6, 896.3/
data time( 55,9:17)/ 965.7, 957.2, 948.9, 941.4, 934.3, 927.4, 920.9, 914.6, 909.3/
data time( 56,9:17)/ 979.0, 970.4, 962.1, 954.6, 947.4, 940.5, 933.9, 927.6, 922.2/
data time( 57,9:17)/ 992.1, 983.5, 975.2, 967.6, 960.4, 953.5, 946.8, 940.4, 935.0/
data time( 58,9:17)/1005.2, 996.6, 988.2, 980.5, 973.3, 966.3, 959.6, 953.2, 947.6/
data time( 59,9:17)/1018.1,1009.5,1001.1, 993.4, 986.1, 979.0, 972.3, 965.8, 960.2/
data time( 60,9:17)/1031.0,1022.3,1013.8,1006.1, 998.8, 991.7, 984.9, 978.3, 972.7/
data time( 61,9:17)/1043.7,1035.0,1026.5,1018.7,1011.3,1004.2, 997.4, 990.8, 985.1/
data time( 62,9:17)/1056.3,1047.6,1039.1,1031.2,1023.8,1016.6,1009.7,1003.1, 997.3/
data time( 63,9:17)/1068.8,1060.0,1051.5,1043.6,1036.2,1028.9,1022.0,1015.3,1009.5/
data time( 64,9:17)/1081.2,1072.4,1063.8,1055.9,1048.4,1041.1,1034.2,1027.4,1021.5/
data time( 65,9:17)/1093.5,1084.7,1076.0,1068.1,1060.5,1053.2,1046.2,1039.4,1033.5/
data time( 66,9:17)/1105.7,1096.8,1088.2,1080.2,1072.6,1065.2,1058.1,1051.3,1045.3/
data time( 67,9:17)/1117.8,1108.8,1100.1,1092.1,1084.5,1077.1,1070.0,1063.1,1057.0/
data time( 68,9:17)/1129.7,1120.8,1112.0,1104.0,1096.3,1088.8,1081.7,1074.8,1068.7/
data time( 69,9:17)/1141.6,1132.6,1123.8,1115.7,1108.0,1100.5,1093.3,1086.3,1080.2/
data time( 70,9:17)/1153.3,1144.3,1135.5,1127.3,1119.6,1112.1,1104.8,1097.8,1091.6/
data time( 71,9:17)/1164.9,1155.8,1147.0,1138.8,1131.0,1123.5,1116.2,1109.1,1102.9/
data time( 72,9:17)/1176.4,1167.3,1158.4,1150.2,1142.4,1134.8,1127.4,1120.3,1114.0/
data time( 73,9:17)/1187.8,1178.7,1169.8,1161.5,1153.6,1146.0,1138.6,1131.5,1125.1/
data time( 74,9:17)/1199.1,1189.9,1181.0,1172.7,1164.8,1157.1,1149.7,1142.5,1136.1/
data time( 75,9:17)/1210.2,1201.0,1192.1,1183.7,1175.8,1168.1,1160.6,1153.3,1146.9/
data time( 76,9:17)/1221.2,1212.0,1203.0,1194.7,1186.7,1178.9,1171.4,1164.1,1157.6/
data time( 77,9:17)/1232.2,1222.9,1213.9,1205.5,1197.4,1189.7,1182.1,1174.8,1168.3/
data time( 78,9:17)/1243.0,1233.7,1224.6,1216.2,1208.1,1200.3,1192.7,1185.3,1178.8/
data time( 79,9:17)/1253.6,1244.3,1235.2,1226.8,1218.7,1210.8,1203.2,1195.8,1189.1/
data time( 80,9:17)/1264.2,1254.8,1245.7,1237.3,1229.1,1221.2,1213.5,1206.1,1199.4/
data time( 81,9:17)/1274.7,1265.3,1256.1,1247.6,1239.4,1231.5,1223.8,1216.3,1209.6/
data time( 82,9:17)/1285.0,1275.6,1266.4,1257.8,1249.6,1241.6,1233.9,1226.4,1219.6/
data time( 83,9:17)/1295.2,1285.7,1276.5,1267.9,1259.7,1251.7,1243.9,1236.3,1229.5/
data time( 84,9:17)/1305.3,1295.8,1286.5,1277.9,1269.6,1261.6,1253.8,1246.2,1239.3/
data time( 85,9:17)/1315.2,1305.7,1296.4,1287.8,1279.5,1271.4,1263.5,1255.9,1249.0/
data time( 86,9:17)/1325.0,1315.5,1306.2,1297.5,1289.2,1281.0,1273.2,1265.5,1258.5/
data time( 87,9:17)/1334.7,1325.2,1315.9,1307.1,1298.7,1290.6,1282.7,1274.9,1267.9/
data time( 88,9:17)/1344.3,1334.7,1325.4,1316.6,1308.2,1300.0,1292.0,1284.3,1277.2/
data time( 89,9:17)/1353.8,1344.2,1334.8,1326.0,1317.5,1309.3,1301.3,1293.5,1286.4/
data time( 90,9:17)/1363.1,1353.4,1344.0,1335.2,1326.7,1318.4,1310.4,1302.6,1295.4/
data time( 91,9:17)/1372.3,1362.6,1353.1,1344.3,1335.8,1327.5,1319.4,1311.5,1304.4/
data time( 92,9:17)/1381.3,1371.6,1362.1,1353.3,1344.7,1336.4,1328.3,1320.3,1313.2/
data time( 93,9:17)/1390.2,1380.5,1371.0,1362.1,1353.5,1345.1,1337.0,1329.1,1321.9/
data time( 94,9:17)/1399.0,1389.3,1379.8,1370.8,1362.2,1353.9,1345.7,1337.8,1330.6/
data time( 95,9:17)/1407.7,1398.0,1388.5,1379.5,1370.9,1362.5,1354.4,1346.4,1339.2/
data time( 96,9:17)/1416.4,1406.7,1397.1,1388.2,1379.5,1371.1,1363.0,1355.0,1347.7/
data time( 97,9:17)/1425.0,1415.3,1405.7,1396.7,1388.1,1379.7,1371.5,1363.5,1356.2/
data time( 98,9:17)/1433.6,1423.8,1414.2,1405.2,1396.6,1388.1,1379.9,1371.9,1364.6/
data time( 99,9:17)/1442.1,1432.2,1422.7,1413.7,1405.0,1396.5,1388.3,1380.3,1372.9/
data time(100,9:17)/1450.4,1440.6,1431.0,1422.0,1413.3,1404.9,1396.6,1388.6,1381.3/
data time(101,9:17)/1458.8,1448.9,1439.3,1430.3,1421.7,1413.2,1405.0,1396.9,1389.6/
data time(102,9:17)/1467.1,1457.3,1447.7,1438.7,1430.0,1421.5,1413.3,1405.3,1398.0/

Stime=-12345.
if(dist<dmin .or. dist> dmax) return
if(dep<0. .or. dep> 700.) return

i0=min(101.,dist-dmin+1)
d0=dmin+(i0-1)
i1=i0+1
j1=2
do while (depth(j1)<dep)
  j1=j1+1
enddo
j0=j1-1
if(time(i0,j0).le.0.) return
if(time(i0,j1).le.0.) return
if(time(i1,j0).le.0.) return
if(time(i1,j1).le.0.) return
x=(dist-d0)
y=(dep-depth(j0))/(depth(j1)-depth(j0))
t0=time(i0,j0)+x*(time(i1,j0)-time(i0,j0))
t1=time(i0,j1)+x*(time(i1,j1)-time(i0,j1))
!write(13,*) 'S dep,dist:',dep,dist,'depth(j0)=',depth(j0)
!write(13,*) 'i0,j0=',i0,j0,' d0,x,y=',d0,x,y
!write(13,*) 'times:',time(i0,j0),time(i1,j0),time(i0,j1),time(i1,j1)
!write(13,*) 'min, sec:',int(time(i0,j0)/60.),time(i0,j0)-int(time(i0,j0)/60.)*60.
Stime=t0+y*(t1-t0)

return
end function

real*4 function smallPtime(dist,dep)

! computes travel time *difference*  pP-P, 0<dist<100 deg, 15<dep<700
! returns 0 if dist or dep outside range
! Interpolates AK135 tables

implicit none
integer :: i0,i1,j0,j1
real*4 :: d0,t0,t1,x,y
real*4 :: dist,dep     ! distance and depth of the earthquake
real*4 :: dmin,dmax,time(100,0:12),depth(0:12)
data dmin,dmax /    1.,  100./
data depth /0.,  15.,  35.,  50., 100., 150., 200., 250.,  &
  300., 400., 500., 600., 700./

data time(1,1:12)/1.8,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0/
data time(2,1:12)/3.6,7.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0/
data time(3,1:12)/3.6,7.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0/
data time(4,1:12)/3.6,7.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0/
data time(5,1:12)/3.6,7.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0/
data time(6,1:12)/3.6,7.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0/
data time(7,1:12)/3.6,7.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0/
data time(8,1:12)/3.6,7.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0/
data time(9,1:12)/3.6,7.6,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0/
data time(10,1:12)/3.6,7.6,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0/
data time(11,1:12)/3.6,7.6,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0/
data time(12,1:12)/3.6,7.6,7.9,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0/
data time(13,1:12)/3.6,7.6,7.9,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0/
data time(14,1:12)/3.6,7.6,8.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0/
data time(15,1:12)/3.7,7.9,8.6,00.0,00.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0/
data time(16,1:12)/3.8,8.1,9.3,20.1,26.2,0.0,0.0,0.0,0.0,0.0,0.0,0.0/
data time(17,1:12)/3.9,8.3,9.7,18.1,26.0,00.0,00.0,0.0,0.0,0.0,0.0,0.0/
data time(18,1:12)/4.0,8.5,10.1,16.1,25.9,32.6,38.8,0.0,0.0,0.0,0.0,0.0/
data time(19,1:12)/4.2,8.9,10.8,17.5,25.8,32.9,39.2,00.0,0.0,0.0,0.0,0.0/
data time(20,1:12)/4.3,9.2,11.5,19.0,25.6,33.2,39.6,45.4,0.0,0.0,0.0,0.0/
data time(21,1:12)/4.3,9.2,11.6,19.2,26.2,33.8,40.7,46.9,00.0,0.0,0.0,0.0/
data time(22,1:12)/4.3,9.3,11.7,19.4,26.9,34.4,41.7,48.4,59.9,0.0,0.0,0.0/
data time(23,1:12)/4.4,9.6,12.2,20.4,28.3,36.1,43.3,50.3,62.0,00.0,0.0,0.0/
data time(24,1:12)/4.5,10.0,12.7,21.4,29.8,37.8,45.0,52.2,64.1,82.7,0.0,0.0/
data time(25,1:12)/4.6,10.0,12.8,21.8,30.5,39.0,46.5,54.0,66.1,83.1,00.0,0.0/
data time(26,1:12)/4.6,10.0,12.8,22.1,31.3,40.2,48.0,55.8,68.2,83.4,93.3,0.0/
data time(27,1:12)/4.6,10.0,12.9,22.2,31.4,40.3,48.5,56.5,70.1,83.8,93.8,0.0/
data time(28,1:12)/4.6,10.0,12.9,22.3,31.5,40.5,49.0,57.2,72.1,84.2,94.3,0.0/
data time(29,1:12)/4.6,10.1,12.9,22.3,31.6,40.7,49.0,57.5,72.4,84.6,94.9,0.0/
data time(30,1:12)/4.6,10.1,12.9,22.4,31.7,40.8,49.0,57.7,72.8,85.1,95.5,0.0/
data time(31,1:12)/4.6,10.1,12.9,22.5,31.8,40.9,49.0,57.8,73.1,85.6,96.1,0.0/
data time(32,1:12)/4.6,10.1,12.9,22.5,31.9,41.0,49.0,58.0,73.4,86.0,96.7,0.0/
data time(33,1:12)/4.6,10.1,12.9,22.5,32.0,41.1,49.5,58.2,73.7,86.4,97.3,0.0/
data time(34,1:12)/4.6,10.1,13.0,22.6,32.1,41.2,50.0,58.5,74.0,86.9,98.0,0.0/
data time(35,1:12)/4.6,10.1,13.1,22.7,32.2,41.4,50.0,58.8,74.4,87.4,98.7,0.0/
data time(36,1:12)/4.6,10.2,13.1,22.8,32.3,41.6,50.0,59.0,74.8,87.9,99.3,0.0/
data time(37,1:12)/4.6,10.2,13.1,22.8,32.4,41.8,50.5,59.3,75.2,88.4,100.0,00.0/
data time(38,1:12)/4.6,10.2,13.1,22.9,32.6,41.9,51.0,59.6,75.6,89.0,100.7,109.6/
data time(39,1:12)/4.6,10.2,13.1,23.0,32.7,42.1,51.0,59.9,76.0,89.6,101.4,110.5/
data time(40,1:12)/4.7,10.2,13.2,23.1,32.8,42.3,51.0,60.2,76.4,90.1,102.1,111.4/
data time(41,1:12)/4.7,10.2,13.2,23.2,32.9,42.5,51.0,60.5,76.9,90.6,102.8,112.4/
data time(42,1:12)/4.7,10.3,13.3,23.2,33.1,42.7,51.0,60.7,77.3,91.2,103.6,113.4/
data time(43,1:12)/4.7,10.3,13.4,23.3,33.2,42.8,51.5,61.0,77.7,91.8,104.3,114.4/
data time(44,1:12)/4.7,10.3,13.4,23.4,33.4,43.0,52.0,61.3,78.1,92.4,105.1,115.4/
data time(45,1:12)/4.7,10.4,13.4,23.5,33.5,43.2,52.0,61.6,78.5,92.9,105.8,116.4/
data time(46,1:12)/4.7,10.4,13.4,23.6,33.6,43.4,52.0,61.9,78.9,93.5,106.6,117.3/
data time(47,1:12)/4.7,10.4,13.4,23.7,33.8,43.6,52.5,62.2,79.3,94.1,107.3,118.2/
data time(48,1:12)/4.7,10.4,13.5,23.7,33.9,43.7,53.0,62.5,79.7,94.6,108.0,119.2/
data time(49,1:12)/4.7,10.4,13.6,23.8,34.0,43.9,53.0,62.8,80.1,95.1,108.7,120.1/
data time(50,1:12)/4.7,10.5,13.6,23.9,34.1,44.1,53.0,63.0,80.5,95.7,109.4,121.0/
data time(51,1:12)/4.8,10.5,13.6,24.0,34.2,44.2,53.5,63.3,80.9,96.2,110.1,121.8/
data time(52,1:12)/4.8,10.5,13.6,24.1,34.4,44.4,54.0,63.6,81.3,96.7,110.7,122.7/
data time(53,1:12)/4.8,10.5,13.6,24.2,34.5,44.6,54.0,63.8,81.7,97.2,111.3,123.6/
data time(54,1:12)/4.8,10.5,13.7,24.2,34.6,44.8,54.0,64.1,82.0,97.7,112.0,124.4/
data time(55,1:12)/4.8,10.6,13.8,24.3,34.8,44.9,54.5,64.3,82.3,98.2,112.7,125.2/
data time(56,1:12)/4.8,10.6,13.8,24.4,34.9,45.1,55.0,64.6,82.7,98.7,113.3,126.0/
data time(57,1:12)/4.8,10.6,13.8,24.5,35.0,45.2,55.0,64.8,83.1,99.1,113.9,126.8/
data time(58,1:12)/4.8,10.6,13.8,24.5,35.1,45.4,55.0,65.1,83.5,99.6,114.5,127.6/
data time(59,1:12)/4.8,10.6,13.9,24.5,35.2,45.6,55.0,65.3,83.8,100.1,115.1,128.4/
data time(60,1:12)/4.8,10.7,13.9,24.6,35.3,45.7,55.0,65.6,84.1,100.6,115.7,129.1/
data time(61,1:12)/4.8,10.7,13.9,24.7,35.4,45.8,55.5,65.8,84.4,101.0,116.3,129.8/
data time(62,1:12)/4.8,10.7,14.0,24.8,35.5,46.0,56.0,66.1,84.8,101.4,116.9,130.5/
data time(63,1:12)/4.9,10.7,14.0,24.8,35.6,46.2,56.0,66.3,85.1,101.9,117.4,131.2/
data time(64,1:12)/4.9,10.7,14.0,24.9,35.7,46.3,56.0,66.5,85.4,102.3,118.0,131.9/
data time(65,1:12)/4.9,10.8,14.1,25.0,35.8,46.4,56.0,66.7,85.8,102.7,118.5,132.6/
data time(66,1:12)/4.9,10.8,14.1,25.0,35.9,46.6,56.0,66.9,86.1,103.1,119.0,133.3/
data time(67,1:12)/4.9,10.8,14.1,25.1,36.0,46.7,56.5,67.2,86.4,103.5,119.5,133.9/
data time(68,1:12)/4.9,10.8,14.1,25.2,36.1,46.8,57.0,67.4,86.7,103.9,120.0,134.5/
data time(69,1:12)/4.9,10.8,14.1,25.2,36.2,46.9,57.0,67.6,86.9,104.3,120.5,135.1/
data time(70,1:12)/4.9,10.8,14.2,25.3,36.3,47.1,57.0,67.8,87.2,104.7,121.0,135.8/
data time(71,1:12)/4.9,10.9,14.2,25.3,36.4,47.2,57.0,68.0,87.5,105.1,121.5,136.4/
data time(72,1:12)/4.9,10.9,14.2,25.4,36.5,47.3,57.0,68.2,87.8,105.5,122.0,137.0/
data time(73,1:12)/4.9,10.9,14.2,25.5,36.6,47.4,57.5,68.4,88.1,105.8,122.5,137.6/
data time(74,1:12)/4.9,10.9,14.3,25.5,36.7,47.6,58.0,68.6,88.4,106.2,123.0,138.2/
data time(75,1:12)/4.9,10.9,14.3,25.5,36.8,47.7,58.0,68.8,88.7,106.6,123.4,138.8/
data time(76,1:12)/4.9,10.9,14.3,25.6,36.8,47.8,58.0,69.0,88.9,106.9,123.9,139.3/
data time(77,1:12)/4.9,10.9,14.4,25.7,36.9,47.9,58.0,69.2,89.2,107.2,124.4,139.9/
data time(78,1:12)/4.9,11.0,14.4,25.7,37.0,48.1,58.0,69.3,89.4,107.6,124.8,140.4/
data time(79,1:12)/4.9,11.0,14.4,25.8,37.1,48.2,58.5,69.5,89.7,107.9,125.2,140.9/
data time(80,1:12)/5.0,11.0,14.4,25.8,37.2,48.3,59.0,69.7,89.9,108.3,125.6,141.5/
data time(81,1:12)/5.0,11.0,14.4,25.8,37.2,48.4,59.0,69.9,90.2,108.7,126.1,142.1/
data time(82,1:12)/5.0,11.0,14.5,25.9,37.3,48.5,59.0,70.1,90.4,109.0,126.5,142.6/
data time(83,1:12)/5.0,11.0,14.5,26.0,37.4,48.6,59.0,70.2,90.7,109.3,126.9,143.1/
data time(84,1:12)/5.0,11.0,14.5,26.0,37.5,48.7,59.0,70.4,90.9,109.6,127.3,143.6/
data time(85,1:12)/5.0,11.1,14.6,26.0,37.6,48.8,59.5,70.6,91.2,109.9,127.7,144.1/
data time(86,1:12)/5.0,11.1,14.6,26.1,37.7,49.0,60.0,70.8,91.4,110.3,128.1,144.6/
data time(87,1:12)/5.0,11.1,14.6,26.2,37.8,49.1,60.0,70.9,91.7,110.6,128.5,145.1/
data time(88,1:12)/5.0,11.1,14.6,26.3,37.9,49.2,60.0,71.1,91.9,110.9,128.9,145.6/
data time(89,1:12)/5.0,11.1,14.6,26.3,37.9,49.2,60.0,71.2,92.1,111.1,129.2,145.9/
data time(90,1:12)/5.0,11.1,14.6,26.3,37.9,49.3,60.0,71.3,92.2,111.3,129.5,146.2/
data time(91,1:12)/5.0,11.1,14.6,26.3,38.0,49.3,60.0,71.4,92.3,111.4,129.6,146.4/
data time(92,1:12)/5.0,11.1,14.6,26.3,38.0,49.4,60.0,71.4,92.4,111.5,129.7,146.6/
data time(93,1:12)/5.0,11.1,14.6,26.3,38.0,49.4,60.0,71.4,92.4,111.6,129.8,146.7/
data time(94,1:12)/5.0,11.1,14.7,26.4,38.0,49.4,60.0,71.5,92.4,111.6,129.9,146.8/
data time(95,1:12)/5.0,11.1,14.7,26.4,38.0,49.5,60.0,71.6,92.5,111.7,130.0,146.9/
data time(96,1:12)/5.0,11.1,14.7,26.4,38.0,49.5,60.0,71.6,92.6,111.8,130.1,147.0/
data time(97,1:12)/5.0,11.1,14.7,26.4,38.0,49.5,60.0,71.6,92.6,111.9,130.2,147.1/
data time(98,1:12)/5.0,11.2,14.7,26.4,38.1,49.6,60.0,71.7,92.7,112.0,130.3,147.3/
data time(99,1:12)/5.0,11.2,14.7,26.4,38.1,49.6,60.0,71.8,92.8,112.1,130.4,147.4/
data time(100,1:12)/5.0,11.2,14.7,26.4,38.1,49.6,60.0,71.8,92.8,112.1,130.5,147.5/

time(1:100,0)=0.

smallPtime=-12345.
if(dist<dmin .or. dist> dmax) return
if(dep<=0.0 .or. dep> 699.9) return

i0=max(1.01,dist-dmin+1)
i0=min(99,i0)
d0=dmin+(i0-1)
i1=i0+1
j1=1
do while (depth(j1)<dep)
  j1=j1+1
enddo
j0=j1-1
! if(abs(time(i0,j0)) < 0.01) return
! if(abs(time(i0,j1)) < 0.01) return
! if(abs(time(i1,j0)) < 0.01) return
! if(abs(time(i1,j1)) < 0.01) return
x=(dist-d0)
y=(dep-depth(j0))/(depth(j1)-depth(j0))
t0=time(i0,j0)+x*(time(i1,j0)-time(i0,j0))
t1=time(i0,j1)+x*(time(i1,j1)-time(i0,j1))
smallPtime=t0+y*(t1-t0)

return
end function

real*4 function slw(dist,depth)

! find slowness at distance dist (degrees) for sourc at depth (km)
! Assumes PKP DF core phase if del>113, else P or Pdiff

! returns slw=-12345. if unable to difference for slowness
! slope dT/dD is computed using a quadratic fit through 3 points

implicit none
integer :: i0,i1,j0,j1
real*4 :: d0,t0,t1,x,y,a,b,xi
real*4 :: dist,depth,del,rad=57.29578,t2

i0=max(1,int(dist))
rad=57.29578
slw=-12345.
if(dist<113) then
  i0=min(i0,99)
  del=i0
  t2=Ptime(del+2.0,depth)
  t1=Ptime(del+1.0,depth)
  t0=Ptime(del,depth)
  if(t0.le.0. .or. t1.le.0. .or. t2.le.0.) return
else
  i0=min(i0,178)
  del=i0
  t2=PKPdftime(del+2.0,depth)
  t1=PKPdftime(del+1.0,depth)
  t0=PKPdftime(del,depth)
  if(t0.le.0. .or. t1.le.0. .or. t2.le.0.) return
endif  
! Now fit t=a*t^2+b*t+t0
a=0.5*(t0-2*t1+t2)
b=t1-t0-a
xi=dist-del
slw=rad*(2*a*xi+b)           ! slowness in sec/radian

return
end function

real*4 function slwS(dist,depth)

! find S slowness at distance dist (degrees) for sourc at depth (km)

! returns slw=-12345. if unable to difference for slowness
! slope dT/dD is computed using a quadratic fit through 3 points

implicit none
integer :: i0,i1,j0,j1
real*4 :: d0,t0,t1,x,y,a,b,xi
real*4 :: dist,depth,del,rad=57.29578,t2

i0=max(1,int(dist))
i0=min(i0,99)
del=i0
slwS=-12345.
t2=Stime(del+2.0,depth)
t1=Stime(del+1.0,depth)
t0=Stime(del,depth)
if(t0.le.0. .or. t1.le.0. .or. t2.le.0.) return
! Now fit t=a*t^2+b*t+t0
a=0.5*(t0-2*t1+t2)
b=t1-t0-a
xi=dist-del
slwS=rad*(2*a*xi+b)           ! slowness in sec/radian

return
end function


real*4 function slwPP(dist,depth)

! find PP slowness at distance dist (degrees) for sourc at depth (km)

! returns slw=-12345. if unable to difference for slowness
! slope dT/dD is computed using a quadratic fit through 3 points

implicit none
integer :: i0,i1,j0,j1
real*4 :: d0,t0,t1,x,y,a,b,xi
real*4 :: dist,depth,del,rad=57.29578,t2

i0=max(1,int(dist))
i0=min(i0,178)
del=i0
slwPP=-12345.
t2=PPtime(del+2.0,depth)
t1=PPtime(del+1.0,depth)
t0=PPtime(del,depth)
if(t0.le.0. .or. t1.le.0. .or. t2.le.0.) return
! Now fit t=a*t^2+b*t+t0
a=0.5*(t0-2*t1+t2)
b=t1-t0-a
xi=dist-del
slwPP=rad*(2*a*xi+b)           ! slowness in sec/radian

return
end function

real*4 function slwsmallP(dist,depth)

! find PP slowness at distance dist (degrees) for sourc at depth (km)

! returns slw=-12345. if unable to difference for slowness
! slope dT/dD is computed using a quadratic fit through 3 points

implicit none
integer :: i0,i1,j0,j1
real*4 :: d0,t0,t1,x,y,a,b,xi
real*4 :: dist,depth,del,rad=57.29578,t2

i0=max(1,int(dist))
i0=min(i0,98)
del=i0
slwsmallP=-12345.
t2=smallPtime(del+2.0,depth)
t1=smallPtime(del+1.0,depth)
t0=smallPtime(del,depth)
if(t0.le.0. .or. t1.le.0. .or. t2.le.0.) return
! Now fit t=a*t^2+b*t+t0
a=0.5*(t0-2*t1+t2)
b=t1-t0-a
xi=dist-del
slwsmallP=rad*(2*a*xi+b)           ! slowness in sec/radian

return
end function

real*4 function Pdiftime(dist,dep)

! computes travel time of  Pdiffracted wave, 101<dist<125 deg, 0<dep<700
! returns -12345. if dist or dep outside range
! Interpolates AK135 tables

implicit none
integer :: i0,i1,j0,j1
real*4 :: d0,t0,t1,x,y
integer :: jdebug=0
real*4 :: dist,dep     ! distance and depth of the earthquake
real*4 :: dmin,dmax,time(26,17),depth(17)
data dmin,dmax /    100.,  125./
data depth /   0.,  15.,  35.,  50., 100., 150., 200., 250.,  &
  300., 350., 400., 450., 500., 550., 600., 650., 700./
data time(1,1: 8)/ 827.0, 824.5, 821.5, 819.7, 813.8, 808.0, 802.2, 796.6/
data time(2,1: 8)/ 831.5, 829.0, 825.9, 824.1, 818.3, 812.4, 806.7, 801.1/
data time(3,1: 8)/ 835.9, 833.4, 830.3, 828.6, 822.7, 816.9, 811.1, 805.5/
data time(4,1: 8)/ 840.4, 837.9, 834.8, 833.0, 827.2, 821.3, 815.6, 810.0/
data time(5,1: 8)/ 844.8, 842.3, 839.2, 837.5, 831.6, 825.8, 820.0, 814.4/
data time(6,1: 8)/ 849.3, 846.8, 843.7, 841.9, 836.0, 830.2, 824.5, 818.8/
data time(7,1: 8)/ 853.7, 851.2, 848.1, 846.4, 840.5, 834.7, 828.9, 823.3/
data time(8,1: 8)/ 858.2, 855.7, 852.6, 850.8, 844.9, 839.1, 833.3, 827.7/
data time(9,1: 8)/ 862.6, 860.1, 857.0, 855.3, 849.4, 843.5, 837.8, 832.2/
data time(10,1: 8)/ 867.0, 864.5, 861.5, 859.7, 853.8, 848.0, 842.2, 836.6/
data time(11,1: 8)/ 871.5, 869.0, 865.9, 864.2, 858.3, 852.4, 846.7, 841.1/
data time(12,1: 8)/ 876.0, 873.4, 870.4, 868.6, 862.7, 856.9, 851.1, 845.5/
data time(13,1: 8)/ 880.4, 877.9, 874.8, 873.0, 867.2, 861.3, 855.6, 850.0/
data time(14,1: 8)/ 884.8, 882.3, 879.3, 877.5, 871.6, 865.8, 860.0, 854.4/
data time(15,1: 8)/ 889.3, 886.8, 883.7, 881.9, 876.1, 870.2, 864.5, 858.9/
data time(16,1: 8)/ 893.7, 891.2, 888.2, 886.4, 880.5, 874.7, 868.9, 863.3/
data time(17,1: 8)/ 898.2, 895.7, 892.6, 890.8, 885.0, 879.1, 873.4, 867.8/
data time(18,1: 8)/ 902.6, 900.1, 897.0, 895.3, 889.4, 883.5, 877.8, 872.2/
data time(19,1: 8)/ 907.1, 904.5, 901.5, 899.7, 893.8, 888.0, 882.3, 876.6/
data time(20,1: 8)/ 911.5, 909.0, 905.9, 904.2, 898.3, 892.4, 886.7, 881.1/
data time(21,1: 8)/ 916.0, 913.4, 910.4, 908.6, 902.7, 896.9, 891.2, 885.5/
data time(22,1: 8)/ 920.4, 917.9, 914.8, 913.0, 907.2, 901.3, 895.6, 890.0/
data time(23,1: 8)/ 924.8, 922.3, 919.3, 917.5, 911.6, 905.8, 900.0, 894.4/
data time(24,1: 8)/ 929.3, 926.8, 923.7, 922.0, 916.1, 910.2, 904.5, 898.9/
data time(25,1: 8)/ 933.7, 931.2, 928.2, 926.4, 920.5, 914.7, 908.9, 903.3/
data time(26,1: 8)/ 938.2, 935.7, 932.6, 930.8, 925.0, 919.1, 913.4, 907.8/
data time(1,9:17)/ 791.2, 785.8, 780.6, 775.7, 771.0, 766.3, 761.8, 757.3, 753.2/
data time(2,9:17)/ 795.6, 790.3, 785.1, 780.2, 775.4, 770.8, 766.2, 761.8, 757.7/
data time(3,9:17)/ 800.0, 794.7, 789.5, 784.6, 779.8, 775.2, 770.7, 766.2, 762.1/
data time(4,9:17)/ 804.5, 799.2, 794.0, 789.0, 784.3, 779.7, 775.1, 770.7, 766.6/
data time(5,9:17)/ 808.9, 803.6, 798.4, 793.5, 788.7, 784.1, 779.5, 775.1, 771.0/
data time(6,9:17)/ 813.4, 808.0, 802.8, 797.9, 793.2, 788.5, 784.0, 779.6, 775.5/
data time(7,9:17)/ 817.8, 812.5, 807.3, 802.4, 797.6, 793.0, 788.5, 784.0, 779.9/
data time(8,9:17)/ 822.3, 816.9, 811.7, 806.8, 802.1, 797.4, 792.9, 788.5, 784.3/
data time(9,9:17)/ 826.7, 821.4, 816.2, 811.3, 806.5, 801.9, 797.3, 792.9, 788.8/
data time(10,9:17)/ 831.2, 825.8, 820.6, 815.7, 811.0, 806.3, 801.8, 797.3, 793.3/
data time(11,9:17)/ 835.6, 830.3, 825.1, 820.2, 815.4, 810.8, 806.2, 801.8, 797.7/
data time(12,9:17)/ 840.0, 834.7, 829.5, 824.6, 819.9, 815.2, 810.7, 806.2, 802.1/
data time(13,9:17)/ 844.5, 839.2, 834.0, 829.1, 824.3, 819.7, 815.1, 810.7, 806.6/
data time(14,9:17)/ 848.9, 843.6, 838.4, 833.5, 828.8, 824.1, 819.6, 815.1, 811.0/
data time(15,9:17)/ 853.4, 848.0, 842.8, 838.0, 833.2, 828.5, 824.0, 819.6, 815.5/
data time(16,9:17)/ 857.8, 852.5, 847.3, 842.4, 837.6, 833.0, 828.5, 824.0, 819.9/
data time(17,9:17)/ 862.3, 856.9, 851.8, 846.8, 842.1, 837.4, 832.9, 828.5, 824.4/
data time(18,9:17)/ 866.7, 861.4, 856.2, 851.3, 846.5, 841.9, 837.3, 832.9, 828.8/
data time(19,9:17)/ 871.2, 865.8, 860.6, 855.7, 851.0, 846.3, 841.8, 837.4, 833.3/
data time(20,9:17)/ 875.6, 870.3, 865.1, 860.2, 855.4, 850.8, 846.2, 841.8, 837.7/
data time(21,9:17)/ 880.1, 874.7, 869.5, 864.6, 859.9, 855.2, 850.7, 846.3, 842.2/
data time(22,9:17)/ 884.5, 879.2, 874.0, 869.1, 864.3, 859.7, 855.1, 850.7, 846.6/
data time(23,9:17)/ 889.0, 883.6, 878.4, 873.5, 868.8, 864.1, 859.6, 855.1, 851.0/
data time(24,9:17)/ 893.4, 888.1, 882.9, 878.0, 873.2, 868.6, 864.0, 859.6, 855.5/
data time(25,9:17)/ 897.8, 892.5, 887.3, 882.4, 877.7, 873.0, 868.5, 864.0, 859.9/
data time(26,9:17)/ 902.3, 897.0, 891.8, 886.9, 882.1, 877.4, 872.9, 868.5, 864.4/

Pdiftime=-12345.
if(jdebug>0) write(13,*) 'Pdiftime dist=',dist,' dmin,dmax=',dmin,dmax
if(dist<dmin .or. dist> dmax) return
if(jdebug>0) write(13,*) 'dep=',dep
if(dep<0. .or. dep> 700.) return

i0=max(1.01,dist-dmin+1)
d0=dmin+(i0-1)
i1=i0+1
j1=2
do while (depth(j1)<dep)
  j1=j1+1
enddo
j0=j1-1
if(jdebug>0) then
  write(13,*) 'i0,j0,i1,j1=',i0,j0,i1,j1
  write(13,*) 'i0,j0=',i0,j0,' d0,x,y=',d0,x,y
  write(13,*) 'times:',time(i0,j0),time(i1,j0),time(i0,j1),time(i1,j1)
endif
if(abs(time(i0,j0)) < -0.00001) return
if(abs(time(i0,j1)) < 0.0) return
if(abs(time(i1,j0)) < 0.0) return
if(abs(time(i1,j1)) < 0.0) return
x=(dist-d0)
y=(dep-depth(j0))/(depth(j1)-depth(j0))
t0=time(i0,j0)+x*(time(i1,j0)-time(i0,j0))
t1=time(i0,j1)+x*(time(i1,j1)-time(i0,j1))
Pdiftime=t0+y*(t1-t0)
if(jdebug>0) then
  write(13,*) 'P dep,dist:',dep,dist,'depth(j0)=',depth(j0),' t=',Pdiftime
  write(13,*) 'min, sec:',int(time(i0,j0)/60.),time(i0,j0)-  &
    int(time(i0,j0)/60.)*60.
endif

return
end function

real*4 function Sdiftime(dist,dep)

! computes travel time of Sdiffracted wave, 100<dist<125 deg, 0<dep<700
! returns -12345. if dist or dep outside range

implicit none
real*4 :: dist,dep     ! distance and depth of the earthquake
integer :: i0,i1,j0,j1
real*4 :: d0,t0,t1,x,y
real*4 :: dmin,dmax,time(26,17),depth(17)

data dmin,dmax /    101.,  125./
data depth /   0.,  15.,  35.,  50., 100., 150., 200., 250.,   &
  300., 350., 400., 450., 500., 550., 600., 650., 700./
data time(1,1: 8)/1522.9,1518.7,1513.6,1510.4,1499.9,1489.5,1479.1,1468.8/
data time(2,1: 8)/1531.2,1527.0,1521.9,1518.7,1508.3,1497.8,1487.4,1477.2/
data time(3,1: 8)/1539.5,1535.3,1530.2,1527.1,1516.6,1506.2,1495.8,1485.5/
data time(4,1: 8)/1547.9,1543.7,1538.6,1535.4,1524.9,1514.5,1504.1,1493.8/
data time(5,1: 8)/1556.2,1552.0,1546.9,1543.8,1533.3,1522.9,1512.5,1502.2/
data time(6,1: 8)/1564.6,1560.4,1555.3,1552.1,1541.6,1531.2,1520.8,1510.5/
data time(7,1: 8)/1572.9,1568.7,1563.6,1560.4,1550.0,1539.5,1529.2,1518.9/
data time(8,1: 8)/1581.2,1577.1,1571.9,1568.8,1558.3,1547.9,1537.5,1527.2/
data time(9,1: 8)/1589.6,1585.4,1580.3,1577.1,1566.7,1556.2,1545.8,1535.6/
data time(10,1: 8)/1597.9,1593.7,1588.6,1585.5,1575.0,1564.6,1554.2,1543.9/
data time(11,1: 8)/1606.3,1602.1,1596.9,1593.8,1583.3,1572.9,1562.5,1552.2/
data time(12,1: 8)/1614.6,1610.4,1605.3,1602.1,1591.7,1581.2,1570.8,1560.6/
data time(13,1: 8)/1622.9,1618.8,1613.6,1610.5,1600.0,1589.6,1579.2,1568.9/
data time(14,1: 8)/1631.3,1627.1,1622.0,1618.8,1608.3,1597.9,1587.5,1577.3/
data time(15,1: 8)/1639.6,1635.4,1630.3,1627.2,1616.7,1606.3,1595.9,1585.6/
data time(16,1: 8)/1648.0,1643.8,1638.7,1635.5,1625.0,1614.6,1604.2,1593.9/
data time(17,1: 8)/1656.3,1652.1,1647.0,1643.8,1633.4,1622.9,1612.6,1602.3/
data time(18,1: 8)/1664.7,1660.5,1655.3,1652.2,1641.7,1631.3,1620.9,1610.6/
data time(19,1: 8)/1673.0,1668.8,1663.7,1660.5,1650.1,1639.6,1629.2,1618.9/
data time(20,1: 8)/1681.3,1677.1,1672.0,1668.9,1658.4,1648.0,1637.6,1627.3/
data time(21,1: 8)/1689.7,1685.5,1680.4,1677.2,1666.7,1656.3,1645.9,1635.6/
data time(22,1: 8)/1698.0,1693.8,1688.7,1685.6,1675.1,1664.7,1654.3,1644.0/
data time(23,1: 8)/1706.3,1702.2,1697.0,1693.9,1683.4,1673.0,1662.6,1652.3/
data time(24,1: 8)/1714.7,1710.5,1705.4,1702.2,1691.8,1681.3,1670.9,1660.7/
data time(25,1: 8)/1723.0,1718.8,1713.7,1710.6,1700.1,1689.7,1679.3,1669.0/
data time(26,1: 8)/1731.4,1727.2,1722.1,1718.9,1708.4,1698.0,1687.6,1677.3/
data time(1,9:17)/1458.8,1448.9,1439.3,1430.3,1421.7,1413.2,1405.0,1396.9,1389.6/
data time(2,9:17)/1467.1,1457.3,1447.7,1438.7,1430.0,1421.5,1413.3,1405.3,1398.0/
data time(3,9:17)/1475.4,1465.6,1456.0,1447.0,1438.3,1429.9,1421.6,1413.6,1406.3/
data time(4,9:17)/1483.8,1474.0,1464.4,1455.4,1446.7,1438.2,1430.0,1422.0,1414.6/
data time(5,9:17)/1492.1,1482.3,1472.7,1463.7,1455.0,1446.6,1438.3,1430.3,1423.0/
data time(6,9:17)/1500.5,1490.7,1481.1,1472.0,1463.4,1454.9,1446.7,1438.7,1431.3/
data time(7,9:17)/1508.8,1499.0,1489.4,1480.4,1471.7,1463.2,1455.0,1447.0,1439.7/
data time(8,9:17)/1517.2,1507.3,1497.7,1488.7,1480.0,1471.6,1463.3,1455.3,1448.0/
data time(9,9:17)/1525.5,1515.7,1506.1,1497.1,1488.4,1479.9,1471.7,1463.7,1456.3/
data time(10,9:17)/1533.8,1524.0,1514.4,1505.4,1496.7,1488.3,1480.0,1472.0,1464.7/
data time(11,9:17)/1542.2,1532.4,1522.8,1513.7,1505.1,1496.6,1488.4,1480.3,1473.0/
data time(12,9:17)/1550.5,1540.7,1531.1,1522.1,1513.4,1504.9,1496.7,1488.7,1481.4/
data time(13,9:17)/1558.9,1549.0,1539.4,1530.4,1521.7,1513.3,1505.1,1497.0,1489.7/
data time(14,9:17)/1567.2,1557.4,1547.8,1538.8,1530.1,1521.6,1513.4,1505.4,1498.1/
data time(15,9:17)/1575.5,1565.7,1556.1,1547.1,1538.4,1530.0,1521.7,1513.7,1506.4/
data time(16,9:17)/1583.9,1574.1,1564.5,1555.4,1546.8,1538.3,1530.1,1522.1,1514.7/
data time(17,9:17)/1592.2,1582.4,1572.8,1563.8,1555.1,1546.7,1538.4,1530.4,1523.1/
data time(18,9:17)/1600.6,1590.7,1581.1,1572.1,1563.4,1555.0,1546.8,1538.7,1531.4/
data time(19,9:17)/1608.9,1599.1,1589.5,1580.5,1571.8,1563.3,1555.1,1547.1,1539.8/
data time(20,9:17)/1617.3,1607.4,1597.8,1588.8,1580.1,1571.7,1563.4,1555.4,1548.1/
data time(21,9:17)/1625.6,1615.8,1606.2,1597.2,1588.5,1580.0,1571.8,1563.8,1556.4/
data time(22,9:17)/1633.9,1624.1,1614.5,1605.5,1596.8,1588.3,1580.1,1572.1,1564.8/
data time(23,9:17)/1642.3,1632.4,1622.8,1613.8,1605.2,1596.7,1588.4,1580.4,1573.1/
data time(24,9:17)/1650.6,1640.8,1631.2,1622.2,1613.5,1605.0,1596.8,1588.8,1581.4/
data time(25,9:17)/1658.9,1649.1,1639.5,1630.5,1621.8,1613.4,1605.1,1597.1,1589.8/
data time(26,9:17)/1667.3,1657.5,1647.9,1638.8,1630.2,1621.7,1613.5,1605.5,1598.1/


Sdiftime=-12345.
if(dist<dmin .or. dist> dmax) return
if(dep<0. .or. dep> 700.) return

i0=min(25.,dist-dmin+1)
d0=dmin+(i0-1)
i1=i0+1
j1=2
do while (depth(j1)<dep)
  j1=j1+1
enddo
j0=j1-1
if(time(i0,j0).le.0.) return
if(time(i0,j1).le.0.) return
if(time(i1,j0).le.0.) return
if(time(i1,j1).le.0.) return
x=(dist-d0)
y=(dep-depth(j0))/(depth(j1)-depth(j0))
t0=time(i0,j0)+x*(time(i1,j0)-time(i0,j0))
t1=time(i0,j1)+x*(time(i1,j1)-time(i0,j1))
!write(13,*) 'S dep,dist:',dep,dist,'depth(j0)=',depth(j0)
!write(13,*) 'i0,j0=',i0,j0,' d0,x,y=',d0,x,y
!write(13,*) 'times:',time(i0,j0),time(i1,j0),time(i0,j1),time(i1,j1)
!write(13,*) 'min, sec:',int(time(i0,j0)/60.),time(i0,j0)-int(time(i0,j0)/60.)*60.
Sdiftime=t0+y*(t1-t0)

return
end function

real*4 function PPtime(dist,dep)

! computes travel time of PP wave, 28<dist<180 deg, 0<dep<700
! returns -12345. if dist or dep outside range

implicit none
integer :: i0,i1,j0,j1
real*4 :: d0,t0,t1,x,y
real*4 :: dist,dep     ! distance and depth of the earthquake
real*4 :: dmin,dmax,time(153,8),depth(8)

data dmin,dmax/28.,180./
data depth /0.,35.,50.,100.,200.,300.,500.,700./

data time(  1,1:8)/   0.0, 411.0, 409.9, 406.3, 399.5, 393.9,   0.0,   0.0/
data time(  2,1:8)/ 426.7, 422.1, 421.0, 417.4, 410.6, 405.0,   0.0,   0.0/
data time(  3,1:8)/ 437.8, 433.3, 432.2, 428.5, 421.7, 416.0,   0.0,   0.0/
data time(  4,1:8)/ 448.9, 444.4, 443.3, 439.6, 432.8, 427.1, 435.3,   0.0/
data time(  5,1:8)/ 460.0, 455.5, 454.4, 450.7, 443.9, 438.1, 444.5,   0.0/
data time(  6,1:8)/ 471.1, 466.6, 465.5, 461.8, 454.9, 449.2, 453.8,   0.0/
data time(  7,1:8)/ 482.2, 477.6, 476.5, 472.9, 466.0, 460.1, 463.0,   0.0/
data time(  8,1:8)/ 493.3, 488.7, 487.6, 483.9, 477.0, 471.1, 464.8,   0.0/
data time(  9,1:8)/ 504.3, 499.7, 498.6, 494.9, 488.0, 482.0, 475.4,   0.0/
data time( 10,1:8)/ 515.3, 510.7, 509.6, 505.9, 498.9, 492.9, 486.0,   0.0/
data time( 11,1:8)/ 526.3, 521.7, 520.6, 516.9, 509.8, 503.7, 496.5,   0.0/
data time( 12,1:8)/ 537.3, 532.7, 531.5, 527.8, 520.7, 514.5, 507.0, 501.8/
data time( 13,1:8)/ 548.2, 543.6, 542.4, 538.7, 531.5, 525.3, 517.4, 510.8/
data time( 14,1:8)/ 559.1, 554.5, 553.3, 549.5, 542.3, 536.0, 527.4, 519.9/
data time( 15,1:8)/ 569.9, 565.3, 564.1, 560.3, 553.0, 546.6, 536.6, 529.0/
data time( 16,1:8)/ 580.7, 576.0, 574.9, 571.0, 563.6, 557.2, 545.7, 538.0/
data time( 17,1:8)/ 591.4, 586.8, 585.6, 581.7, 574.2, 567.7, 554.8, 547.0/
data time( 18,1:8)/ 602.1, 597.4, 596.2, 592.3, 584.8, 577.1, 564.0, 556.0/
data time( 19,1:8)/ 612.7, 608.0, 606.8, 602.8, 594.4, 586.2, 573.0, 564.9/
data time( 20,1:8)/ 623.2, 618.5, 617.1, 612.5, 603.5, 595.3, 582.1, 573.9/
data time( 21,1:8)/ 632.6, 627.6, 626.2, 621.6, 612.7, 604.4, 591.1, 582.8/
data time( 22,1:8)/ 641.7, 636.8, 635.4, 630.7, 621.7, 613.5, 600.2, 591.6/
data time( 23,1:8)/ 650.9, 645.9, 644.5, 639.8, 630.8, 622.6, 609.2, 600.5/
data time( 24,1:8)/ 659.9, 655.0, 653.6, 648.9, 639.9, 631.6, 618.1, 609.4/
data time( 25,1:8)/ 669.0, 664.0, 662.6, 658.0, 648.9, 640.6, 627.0, 618.2/
data time( 26,1:8)/ 678.1, 673.1, 671.7, 667.0, 657.9, 649.6, 635.9, 627.0/
data time( 27,1:8)/ 687.1, 682.1, 680.7, 676.0, 666.9, 658.5, 644.8, 635.8/
data time( 28,1:8)/ 696.1, 691.1, 689.6, 684.9, 675.8, 667.4, 653.7, 644.6/
data time( 29,1:8)/ 705.0, 700.0, 698.6, 693.9, 684.7, 676.3, 662.5, 653.4/
data time( 30,1:8)/ 713.9, 708.9, 707.5, 702.8, 693.6, 685.2, 671.3, 662.2/
data time( 31,1:8)/ 722.8, 717.8, 716.4, 711.6, 702.5, 694.0, 680.1, 670.9/
data time( 32,1:8)/ 731.7, 726.7, 725.2, 720.5, 711.3, 702.8, 688.9, 679.6/
data time( 33,1:8)/ 740.5, 735.5, 734.1, 729.4, 720.1, 711.7, 697.7, 688.3/
data time( 34,1:8)/ 749.4, 744.4, 742.9, 738.2, 729.0, 720.5, 706.5, 697.0/
data time( 35,1:8)/ 758.2, 753.2, 751.8, 747.0, 737.8, 729.3, 715.2, 705.6/
data time( 36,1:8)/ 767.0, 762.0, 760.6, 755.8, 746.6, 738.0, 723.9, 714.2/
data time( 37,1:8)/ 775.8, 770.8, 769.4, 764.6, 755.3, 746.8, 732.6, 722.8/
data time( 38,1:8)/ 784.6, 779.6, 778.1, 773.4, 764.1, 755.5, 741.3, 731.4/
data time( 39,1:8)/ 793.4, 788.3, 786.9, 782.1, 772.8, 764.2, 749.9, 739.9/
data time( 40,1:8)/ 802.1, 797.0, 795.6, 790.8, 781.5, 772.9, 758.5, 748.4/
data time( 41,1:8)/ 810.8, 805.7, 804.3, 799.5, 790.1, 781.5, 767.1, 756.9/
data time( 42,1:8)/ 819.5, 814.4, 813.0, 808.1, 798.8, 790.1, 775.6, 765.3/
data time( 43,1:8)/ 828.1, 823.0, 821.6, 816.8, 807.4, 798.7, 784.1, 773.7/
data time( 44,1:8)/ 836.7, 831.7, 830.2, 825.4, 815.9, 807.2, 792.6, 782.1/
data time( 45,1:8)/ 845.3, 840.2, 838.8, 833.9, 824.5, 815.7, 801.1, 790.4/
data time( 46,1:8)/ 853.9, 848.8, 847.3, 842.5, 833.0, 824.2, 809.5, 798.7/
data time( 47,1:8)/ 862.4, 857.3, 855.8, 851.0, 841.5, 832.7, 817.9, 807.0/
data time( 48,1:8)/ 870.9, 865.8, 864.3, 859.4, 849.9, 841.1, 826.2, 815.3/
data time( 49,1:8)/ 879.3, 874.2, 872.8, 867.9, 858.3, 849.5, 834.5, 823.5/
data time( 50,1:8)/ 887.8, 882.7, 881.2, 876.3, 866.7, 857.8, 842.8, 831.7/
data time( 51,1:8)/ 896.2, 891.0, 889.6, 884.7, 875.1, 866.1, 851.1, 839.8/
data time( 52,1:8)/ 904.5, 899.4, 897.9, 893.0, 883.4, 874.4, 859.3, 848.0/
data time( 53,1:8)/ 912.8, 907.7, 906.2, 901.3, 891.7, 882.7, 867.5, 856.0/
data time( 54,1:8)/ 921.1, 916.0, 914.5, 909.6, 899.9, 890.9, 875.6, 864.1/
data time( 55,1:8)/ 929.4, 924.3, 922.8, 917.8, 908.1, 899.1, 883.7, 872.1/
data time( 56,1:8)/ 937.6, 932.5, 931.0, 926.0, 916.3, 907.2, 891.8, 880.1/
data time( 57,1:8)/ 945.8, 940.7, 939.2, 934.2, 924.4, 915.4, 899.9, 888.1/
data time( 58,1:8)/ 954.0, 948.8, 947.3, 942.3, 932.5, 923.4, 907.9, 896.0/
data time( 59,1:8)/ 962.1, 956.9, 955.4, 950.4, 940.6, 931.5, 915.9, 903.9/
data time( 60,1:8)/ 970.2, 965.0, 963.5, 958.5, 948.7, 939.5, 923.8, 911.7/
data time( 61,1:8)/ 978.2, 973.0, 971.5, 966.5, 956.7, 947.5, 931.7, 919.6/
data time( 62,1:8)/ 986.2, 981.1, 979.5, 974.5, 964.6, 955.4, 939.6, 927.4/
data time( 63,1:8)/ 994.2, 989.0, 987.5, 982.5, 972.6, 963.3, 947.4, 935.1/
data time( 64,1:8)/1002.1, 997.0, 995.4, 990.4, 980.5, 971.2, 955.2, 942.8/
data time( 65,1:8)/1010.1,1004.9,1003.3, 998.3, 988.3, 979.0, 963.0, 950.5/
data time( 66,1:8)/1017.9,1012.7,1011.2,1006.1, 996.2, 986.8, 970.8, 958.2/
data time( 67,1:8)/1025.8,1020.6,1019.0,1013.9,1003.9, 994.6, 978.5, 965.8/
data time( 68,1:8)/1033.6,1028.4,1026.8,1021.7,1011.7,1002.3, 986.1, 973.4/
data time( 69,1:8)/1041.3,1036.1,1034.6,1029.4,1019.4,1010.0, 993.7, 980.9/
data time( 70,1:8)/1049.0,1043.8,1042.3,1037.1,1027.1,1017.7,1001.3, 988.4/
data time( 71,1:8)/1056.7,1051.5,1050.0,1044.8,1034.7,1025.3,1008.9, 995.9/
data time( 72,1:8)/1064.4,1059.2,1057.6,1052.4,1042.4,1032.9,1016.4,1003.3/
data time( 73,1:8)/1072.0,1066.8,1065.2,1060.0,1049.9,1040.4,1023.9,1010.7/
data time( 74,1:8)/1079.6,1074.3,1072.8,1067.6,1057.5,1047.9,1031.4,1018.1/
data time( 75,1:8)/1087.1,1081.9,1080.3,1075.1,1065.0,1055.4,1038.8,1025.5/
data time( 76,1:8)/1094.6,1089.4,1087.8,1082.6,1072.4,1062.8,1046.2,1032.8/
data time( 77,1:8)/1102.1,1096.8,1095.3,1090.1,1079.9,1070.3,1053.5,1040.0/
data time( 78,1:8)/1109.5,1104.3,1102.7,1097.5,1087.2,1077.6,1060.8,1047.3/
data time( 79,1:8)/1116.9,1111.7,1110.1,1104.9,1094.6,1085.0,1068.1,1054.5/
data time( 80,1:8)/1124.3,1119.0,1117.5,1112.2,1101.9,1092.3,1075.3,1061.6/
data time( 81,1:8)/1131.6,1126.3,1124.8,1119.5,1109.2,1099.5,1082.5,1068.8/
data time( 82,1:8)/1138.9,1133.6,1132.1,1126.8,1116.5,1106.7,1089.7,1075.9/
data time( 83,1:8)/1146.2,1140.9,1139.3,1134.0,1123.7,1113.9,1096.8,1082.9/
data time( 84,1:8)/1153.4,1148.1,1146.5,1141.2,1130.9,1121.1,1103.9,1090.0/
data time( 85,1:8)/1160.6,1155.3,1153.7,1148.4,1138.0,1128.2,1111.0,1096.9/
data time( 86,1:8)/1167.7,1162.4,1160.8,1155.5,1145.1,1135.3,1118.0,1103.9/
data time( 87,1:8)/1174.8,1169.5,1167.9,1162.6,1152.2,1142.3,1125.0,1110.8/
data time( 88,1:8)/1181.9,1176.6,1175.0,1169.6,1159.2,1149.3,1132.0,1117.7/
data time( 89,1:8)/1188.9,1183.6,1182.0,1176.7,1166.2,1156.3,1138.9,1124.6/
data time( 90,1:8)/1195.9,1190.6,1189.0,1183.6,1173.2,1163.2,1145.8,1131.4/
data time( 91,1:8)/1202.9,1197.5,1195.9,1190.6,1180.1,1170.1,1152.6,1138.2/
data time( 92,1:8)/1209.8,1204.5,1202.9,1197.5,1187.0,1177.0,1159.4,1144.9/
data time( 93,1:8)/1216.7,1211.4,1209.7,1204.4,1193.8,1183.8,1166.2,1151.6/
data time( 94,1:8)/1223.5,1218.2,1216.6,1211.2,1200.6,1190.6,1173.0,1158.3/
data time( 95,1:8)/1230.3,1225.0,1223.4,1218.0,1207.4,1197.4,1179.7,1164.9/
data time( 96,1:8)/1237.1,1231.8,1230.2,1224.7,1214.1,1204.1,1186.3,1171.5/
data time( 97,1:8)/1243.9,1238.5,1236.9,1231.5,1220.8,1210.8,1193.0,1178.1/
data time( 98,1:8)/1250.6,1245.2,1243.6,1238.2,1227.5,1217.4,1199.6,1184.7/
data time( 99,1:8)/1257.2,1251.9,1250.2,1244.8,1234.1,1224.0,1206.1,1191.2/
data time(100,1:8)/1263.9,1258.5,1256.9,1251.4,1240.7,1230.6,1212.7,1197.6/
data time(101,1:8)/1270.5,1265.1,1263.5,1258.0,1247.3,1237.2,1219.2,1204.1/
data time(102,1:8)/1277.0,1271.7,1270.0,1264.6,1253.8,1243.7,1225.6,1210.5/
data time(103,1:8)/1283.6,1278.2,1276.5,1271.1,1260.3,1250.1,1232.0,1216.8/
data time(104,1:8)/1290.0,1284.7,1283.0,1277.5,1266.8,1256.6,1238.4,1223.2/
data time(105,1:8)/1296.5,1291.1,1289.5,1284.0,1273.2,1263.0,1244.8,1229.5/
data time(106,1:8)/1302.9,1297.5,1295.9,1290.4,1279.6,1269.3,1251.1,1235.7/
data time(107,1:8)/1309.3,1303.9,1302.2,1296.7,1285.9,1275.7,1257.4,1241.9/
data time(108,1:8)/1315.6,1310.2,1308.6,1303.1,1292.2,1282.0,1263.6,1248.1/
data time(109,1:8)/1321.9,1316.5,1314.9,1309.4,1298.5,1288.2,1269.8,1254.3/
data time(110,1:8)/1328.2,1322.8,1321.1,1315.6,1304.8,1294.4,1276.0,1260.4/
data time(111,1:8)/1334.5,1329.0,1327.4,1321.8,1311.0,1300.6,1282.2,1266.5/
data time(112,1:8)/1340.7,1335.2,1333.6,1328.0,1317.1,1306.8,1288.3,1272.5/
data time(113,1:8)/1346.8,1341.4,1339.7,1334.2,1323.3,1312.9,1294.3,1278.6/
data time(114,1:8)/1352.9,1347.5,1345.8,1340.3,1329.3,1319.0,1300.4,1284.5/
data time(115,1:8)/1359.0,1353.6,1351.9,1346.4,1335.4,1325.0,1306.4,1290.5/
data time(116,1:8)/1365.1,1359.7,1358.0,1352.4,1341.4,1331.0,1312.3,1296.4/
data time(117,1:8)/1371.1,1365.7,1364.0,1358.4,1347.4,1337.0,1318.2,1302.3/
data time(118,1:8)/1377.1,1371.6,1370.0,1364.4,1353.4,1342.9,1324.1,1308.1/
data time(119,1:8)/1383.0,1377.6,1375.9,1370.3,1359.3,1348.8,1330.0,1313.9/
data time(120,1:8)/1388.9,1383.5,1381.8,1376.2,1365.2,1354.7,1335.8,1319.7/
data time(121,1:8)/1394.8,1389.4,1387.7,1382.0,1371.0,1360.5,1341.6,1325.4/
data time(122,1:8)/1400.6,1395.2,1393.5,1387.9,1376.8,1366.3,1347.3,1331.1/
data time(123,1:8)/1406.4,1401.0,1399.3,1393.6,1382.6,1372.0,1353.0,1336.7/
data time(124,1:8)/1412.2,1406.7,1405.0,1399.4,1388.3,1377.7,1358.7,1342.4/
data time(125,1:8)/1417.9,1412.4,1410.7,1405.1,1394.0,1383.4,1364.3,1347.9/
data time(126,1:8)/1423.6,1418.1,1416.4,1410.8,1399.6,1389.0,1369.9,1353.5/
data time(127,1:8)/1429.2,1423.8,1422.1,1416.4,1405.3,1394.6,1375.5,1359.0/
data time(128,1:8)/1434.9,1429.4,1427.7,1422.0,1410.8,1400.2,1381.0,1364.5/
data time(129,1:8)/1440.4,1435.0,1433.2,1427.6,1416.4,1405.7,1386.5,1369.9/
data time(130,1:8)/1446.0,1440.5,1438.8,1433.1,1421.9,1411.2,1392.0,1375.4/
data time(131,1:8)/1451.5,1446.0,1444.3,1438.6,1427.4,1416.7,1397.4,1380.7/
data time(132,1:8)/1456.9,1451.5,1449.7,1444.0,1432.8,1422.1,1402.8,1386.1/
data time(133,1:8)/1462.4,1456.9,1455.2,1449.5,1438.2,1427.5,1408.1,1391.4/
data time(134,1:8)/1467.8,1462.3,1460.5,1454.8,1443.6,1432.8,1413.4,1396.6/
data time(135,1:8)/1473.1,1467.6,1465.9,1460.2,1448.9,1438.1,1418.7,1401.8/
data time(136,1:8)/1478.4,1472.9,1471.2,1465.5,1454.2,1443.4,1423.9,1407.0/
data time(137,1:8)/1483.7,1478.2,1476.5,1470.7,1459.4,1448.6,1429.1,1412.2/
data time(138,1:8)/1488.9,1483.4,1481.7,1476.0,1464.6,1453.8,1434.3,1417.3/
data time(139,1:8)/1494.1,1488.6,1486.9,1481.1,1469.8,1459.0,1439.4,1422.4/
data time(140,1:8)/1499.3,1493.8,1492.1,1486.3,1475.0,1464.1,1444.5,1427.4/
data time(141,1:8)/1504.4,1498.9,1497.2,1491.4,1480.0,1469.2,1449.5,1432.4/
data time(142,1:8)/1509.5,1504.0,1502.3,1496.5,1485.1,1474.2,1454.5,1437.4/
data time(143,1:8)/1514.6,1509.0,1507.3,1501.5,1490.1,1479.2,1459.5,1442.3/
data time(144,1:8)/1519.6,1514.0,1512.3,1506.5,1495.1,1484.2,1464.4,1447.2/
data time(145,1:8)/1524.5,1519.0,1517.2,1511.5,1500.0,1489.1,1469.3,1452.0/
data time(146,1:8)/1529.5,1523.9,1522.2,1516.4,1504.9,1494.0,1474.2,1456.8/
data time(147,1:8)/1534.4,1528.8,1527.1,1521.3,1509.8,1498.9,1479.0,1461.5/
data time(148,1:8)/1539.2,1533.7,1531.9,1526.1,1514.6,1503.6,1483.7,1466.2/
data time(149,1:8)/1544.0,1538.4,1536.7,1530.8,1519.4,1508.4,1488.4,1470.9/
data time(150,1:8)/1548.7,1543.2,1541.4,1535.6,1524.1,1513.1,1493.1,1475.6/
data time(151,1:8)/1553.4,1547.9,1546.1,1540.3,1528.8,1517.8,1497.8,1480.3/
data time(152,1:8)/1558.1,1552.6,1550.8,1545.0,1533.5,1522.5,1502.4,1484.9/
data time(153,1:8)/1562.8,1557.2,1555.5,1549.6,1538.1,1527.1,1507.1,1489.6/

PPtime=-12345.
if(dist<dmin .or. dist> dmax) return
if(dep<0. .or. dep> 700.) return

i0=min(152.,dist-dmin+1)
d0=dmin+(i0-1)
i1=i0+1
j1=2
do while (depth(j1)<dep)
  j1=j1+1
enddo
j0=j1-1
if(time(i0,j0).le.0.) return
if(time(i0,j1).le.0.) return
if(time(i1,j0).le.0.) return
if(time(i1,j1).le.0.) return
x=(dist-d0)
y=(dep-depth(j0))/(depth(j1)-depth(j0))
t0=time(i0,j0)+x*(time(i1,j0)-time(i0,j0))
t1=time(i0,j1)+x*(time(i1,j1)-time(i0,j1))
PPtime=t0+y*(t1-t0)

return
end function

real*4 function SStime(dist,dep)

! computes travel time of SS wave, 30<dist<180 deg, 0<dep<700
! returns -12345. if dist or dep outside range

implicit none
integer :: i0,i1,j0,j1
real*4 :: d0,t0,t1,x,y
real*4 :: dist,dep     ! distance and depth of the earthquake
real*4 :: dmin,dmax,time(153,8),depth(8)

data dmin,dmax/28.,180./
data depth /0.,35.,50.,100.,200.,300.,500.,700./

! times at 28 extrapolated except for 100 km and deeper
data time(  1,1:8)/ 755.4, 748.2, 746.5, 740.3, 728.6, 718.2,   0.0,   0.0/
data time(  2,1:8)/ 775.9, 768.7, 766.9, 760.8, 749.0, 738.7,   0.0,   0.0/
data time(  3,1:8)/ 796.4, 789.2, 787.3, 781.2, 769.5, 752.4, 775.4,   0.0/
data time(  4,1:8)/ 816.9, 809.7, 807.8, 801.7, 789.9, 775.0, 792.1,   0.0/
data time(  5,1:8)/ 837.3, 830.1, 828.3, 822.1, 810.3, 797.6, 808.8,   0.0/
data time(  6,1:8)/ 857.8, 850.6, 848.7, 842.5, 824.3, 820.0, 825.5,   0.0/
data time(  7,1:8)/ 878.2, 871.0, 869.1, 862.9, 847.4, 840.2, 828.4,   0.0/
data time(  8,1:8)/ 898.5, 891.3, 889.4, 883.2, 870.3, 860.3, 847.8, 845.0/
data time(  9,1:8)/ 918.9, 911.6, 909.7, 903.5, 891.4, 880.4, 867.1, 861.3/
data time( 10,1:8)/ 939.2, 931.9, 930.0, 923.0, 911.5, 900.3, 886.4, 877.6/
data time( 11,1:8)/ 959.4, 952.1, 949.8, 943.8, 931.5, 920.1, 905.6, 893.8/
data time( 12,1:8)/ 979.5, 972.2, 970.3, 963.8, 951.4, 939.9, 924.6, 910.0/
data time( 13,1:8)/ 999.5, 992.2, 990.3, 983.8, 971.1, 959.5, 941.5, 926.1/
data time( 14,1:8)/1019.5,1012.1,1010.1,1003.6, 990.8, 978.9, 957.9, 942.2/
data time( 15,1:8)/1039.3,1031.9,1029.9,1023.3,1010.3, 998.2, 974.2, 958.1/
data time( 16,1:8)/1059.0,1051.6,1049.6,1042.9,1029.7,1016.0, 990.4, 973.9/
data time( 17,1:8)/1078.6,1071.1,1069.1,1062.3,1047.8,1032.3,1006.6, 989.8/
data time( 18,1:8)/1098.0,1090.5,1088.4,1080.4,1064.1,1048.5,1022.7,1005.6/
data time( 19,1:8)/1115.8,1107.6,1105.1,1096.8,1080.4,1064.7,1038.7,1021.3/
data time( 20,1:8)/1132.1,1123.9,1121.3,1113.0,1096.6,1080.9,1054.5,1037.1/
data time( 21,1:8)/1148.3,1140.1,1137.5,1129.2,1112.7,1096.9,1070.3,1052.8/
data time( 22,1:8)/1164.4,1156.2,1153.7,1145.3,1128.7,1112.8,1086.1,1068.6/
data time( 23,1:8)/1180.5,1172.3,1169.7,1161.3,1144.6,1128.6,1101.9,1084.3/
data time( 24,1:8)/1196.4,1188.2,1185.6,1177.1,1160.4,1144.4,1117.7,1100.0/
data time( 25,1:8)/1212.3,1204.0,1201.4,1192.9,1176.2,1160.2,1133.4,1115.7/
data time( 26,1:8)/1228.1,1219.8,1217.2,1208.7,1191.9,1175.9,1149.2,1131.4/
data time( 27,1:8)/1243.9,1235.6,1233.0,1224.5,1207.7,1191.7,1164.9,1147.1/
data time( 28,1:8)/1259.6,1251.3,1248.8,1240.2,1223.4,1207.4,1180.6,1162.7/
data time( 29,1:8)/1275.4,1267.1,1264.5,1256.0,1239.2,1223.1,1196.3,1178.3/
data time( 30,1:8)/1291.1,1282.8,1280.3,1271.7,1254.9,1238.8,1212.0,1193.9/
data time( 31,1:8)/1306.9,1298.6,1296.0,1287.4,1270.6,1254.5,1227.6,1209.5/
data time( 32,1:8)/1322.6,1314.3,1311.7,1303.1,1286.3,1270.2,1243.2,1225.0/
data time( 33,1:8)/1338.3,1330.0,1327.4,1318.8,1302.0,1285.9,1258.8,1240.5/
data time( 34,1:8)/1354.0,1345.7,1343.1,1334.5,1317.6,1301.5,1274.4,1255.9/
data time( 35,1:8)/1369.6,1361.3,1358.7,1350.2,1333.3,1317.1,1290.0,1271.4/
data time( 36,1:8)/1385.3,1377.0,1374.4,1365.8,1348.9,1332.7,1305.5,1286.8/
data time( 37,1:8)/1400.9,1392.6,1390.0,1381.4,1364.5,1348.3,1321.0,1302.1/
data time( 38,1:8)/1416.5,1408.2,1405.6,1397.0,1380.0,1363.8,1336.4,1317.4/
data time( 39,1:8)/1432.0,1423.7,1421.1,1412.5,1395.5,1379.3,1351.8,1332.7/
data time( 40,1:8)/1447.6,1439.2,1436.6,1428.0,1411.0,1394.7,1367.2,1347.9/
data time( 41,1:8)/1463.1,1454.7,1452.1,1443.5,1426.4,1410.1,1382.5,1363.1/
data time( 42,1:8)/1478.5,1470.2,1467.6,1458.9,1441.8,1425.5,1397.8,1378.3/
data time( 43,1:8)/1493.9,1485.6,1483.0,1474.3,1457.2,1440.8,1413.0,1393.4/
data time( 44,1:8)/1509.3,1500.9,1498.3,1489.6,1472.5,1456.1,1428.2,1408.5/
data time( 45,1:8)/1524.7,1516.3,1513.7,1505.0,1487.8,1471.3,1443.4,1423.5/
data time( 46,1:8)/1539.9,1531.6,1528.9,1520.2,1503.0,1486.6,1458.5,1438.5/
data time( 47,1:8)/1555.2,1546.8,1544.2,1535.5,1518.2,1501.7,1473.6,1453.5/
data time( 48,1:8)/1570.4,1562.0,1559.4,1550.7,1533.4,1516.8,1488.6,1468.4/
data time( 49,1:8)/1585.6,1577.2,1574.6,1565.8,1548.5,1531.9,1503.6,1483.2/
data time( 50,1:8)/1600.7,1592.3,1589.7,1580.9,1563.6,1547.0,1518.6,1498.0/
data time( 51,1:8)/1615.8,1607.4,1604.7,1596.0,1578.6,1561.9,1533.5,1512.8/
data time( 52,1:8)/1630.9,1622.4,1619.8,1611.0,1593.6,1576.9,1548.3,1527.5/
data time( 53,1:8)/1645.9,1637.4,1634.8,1625.9,1608.5,1591.8,1563.1,1542.2/
data time( 54,1:8)/1660.8,1652.4,1649.7,1640.9,1623.4,1606.6,1577.9,1556.8/
data time( 55,1:8)/1675.7,1667.3,1664.6,1655.7,1638.2,1621.4,1592.6,1571.4/
data time( 56,1:8)/1690.6,1682.1,1679.4,1670.6,1653.0,1636.2,1607.3,1585.9/
data time( 57,1:8)/1705.4,1696.9,1694.2,1685.3,1667.8,1650.9,1621.9,1600.4/
data time( 58,1:8)/1720.1,1711.7,1709.0,1700.1,1682.5,1665.6,1636.5,1614.8/
data time( 59,1:8)/1734.8,1726.4,1723.7,1714.8,1697.1,1680.2,1651.0,1629.2/
data time( 60,1:8)/1749.5,1741.0,1738.3,1729.4,1711.7,1694.7,1665.4,1643.6/
data time( 61,1:8)/1764.1,1755.6,1752.9,1744.0,1726.3,1709.2,1679.9,1657.8/
data time( 62,1:8)/1778.7,1770.2,1767.5,1758.5,1740.8,1723.7,1694.2,1672.1/
data time( 63,1:8)/1793.2,1784.7,1782.0,1773.0,1755.2,1738.1,1708.6,1686.3/
data time( 64,1:8)/1807.7,1799.1,1796.4,1787.4,1769.6,1752.5,1722.8,1700.4/
data time( 65,1:8)/1822.1,1813.5,1810.8,1801.8,1784.0,1766.8,1737.0,1714.5/
data time( 66,1:8)/1836.4,1827.9,1825.2,1816.1,1798.3,1781.0,1751.2,1728.5/
data time( 67,1:8)/1850.7,1842.2,1839.5,1830.4,1812.5,1795.2,1765.3,1742.5/
data time( 68,1:8)/1865.0,1856.4,1853.7,1844.6,1826.7,1809.4,1779.4,1756.4/
data time( 69,1:8)/1879.2,1870.6,1867.9,1858.8,1840.8,1823.5,1793.4,1770.3/
data time( 70,1:8)/1893.3,1884.8,1882.0,1872.9,1854.9,1837.5,1807.3,1784.1/
data time( 71,1:8)/1907.4,1898.8,1896.1,1887.0,1868.9,1851.5,1821.2,1797.9/
data time( 72,1:8)/1921.5,1912.9,1910.1,1901.0,1882.9,1865.5,1835.1,1811.6/
data time( 73,1:8)/1935.5,1926.9,1924.1,1914.9,1896.8,1879.3,1848.9,1825.3/
data time( 74,1:8)/1949.4,1940.8,1938.0,1928.8,1910.7,1893.2,1862.6,1838.9/
data time( 75,1:8)/1963.3,1954.6,1951.9,1942.7,1924.5,1906.9,1876.3,1852.5/
data time( 76,1:8)/1977.1,1968.5,1965.7,1956.5,1938.3,1920.7,1889.9,1866.0/
data time( 77,1:8)/1990.9,1982.2,1979.4,1970.2,1952.0,1934.3,1903.5,1879.4/
data time( 78,1:8)/2004.6,1995.9,1993.1,1983.9,1965.6,1947.9,1917.0,1892.9/
data time( 79,1:8)/2018.2,2009.6,2006.8,1997.5,1979.2,1961.5,1930.5,1906.2/
data time( 80,1:8)/2031.8,2023.2,2020.4,2011.1,1992.7,1975.0,1943.9,1919.5/
data time( 81,1:8)/2045.4,2036.7,2033.9,2024.6,2006.2,1988.5,1957.3,1932.8/
data time( 82,1:8)/2058.9,2050.2,2047.4,2038.1,2019.7,2001.9,1970.6,1946.0/
data time( 83,1:8)/2072.3,2063.6,2060.8,2051.5,2033.1,2015.2,1983.9,1959.1/
data time( 84,1:8)/2085.7,2077.0,2074.2,2064.9,2046.4,2028.5,1997.1,1972.2/
data time( 85,1:8)/2099.1,2090.4,2087.5,2078.2,2059.7,2041.8,2010.2,1985.3/
data time( 86,1:8)/2112.4,2103.6,2100.8,2091.4,2072.9,2054.9,2023.3,1998.2/
data time( 87,1:8)/2125.6,2116.9,2114.0,2104.6,2086.0,2068.1,2036.4,2011.2/
data time( 88,1:8)/2138.8,2130.0,2127.2,2117.8,2099.2,2081.1,2049.4,2024.1/
data time( 89,1:8)/2151.9,2143.1,2140.3,2130.9,2112.2,2094.2,2062.3,2036.9/
data time( 90,1:8)/2164.9,2156.2,2153.3,2143.9,2125.2,2107.1,2075.2,2049.7/
data time( 91,1:8)/2177.9,2169.2,2166.3,2156.9,2138.1,2120.0,2088.0,2062.4/
data time( 92,1:8)/2190.9,2182.1,2179.3,2169.8,2151.0,2132.9,2100.8,2075.0/
data time( 93,1:8)/2203.8,2195.0,2192.1,2182.7,2163.9,2145.7,2113.5,2087.6/
data time( 94,1:8)/2216.6,2207.8,2205.0,2195.5,2176.6,2158.4,2126.2,2100.2/
data time( 95,1:8)/2229.4,2220.6,2217.7,2208.2,2189.4,2171.1,2138.8,2112.7/
data time( 96,1:8)/2242.1,2233.3,2230.4,2220.9,2202.0,2183.7,2151.3,2125.1/
data time( 97,1:8)/2254.8,2246.0,2243.1,2233.6,2214.6,2196.3,2163.8,2137.5/
data time( 98,1:8)/2267.4,2258.6,2255.7,2246.1,2227.2,2208.8,2176.2,2149.9/
data time( 99,1:8)/2280.0,2271.1,2268.2,2258.7,2239.7,2221.3,2188.6,2162.1/
data time(100,1:8)/2292.5,2283.6,2280.7,2271.1,2252.1,2233.7,2201.0,2174.4/
data time(101,1:8)/2304.9,2296.0,2293.2,2283.6,2264.5,2246.0,2213.2,2186.5/
data time(102,1:8)/2317.3,2308.4,2305.5,2295.9,2276.8,2258.3,2225.4,2198.7/
data time(103,1:8)/2329.6,2320.7,2317.8,2308.2,2289.1,2270.6,2237.6,2210.7/
data time(104,1:8)/2341.9,2333.0,2330.1,2320.5,2301.3,2282.8,2249.7,2222.7/
data time(105,1:8)/2354.1,2345.2,2342.3,2332.6,2313.5,2294.9,2261.8,2234.7/
data time(106,1:8)/2366.3,2357.4,2354.5,2344.8,2325.6,2307.0,2273.8,2246.6/
data time(107,1:8)/2378.4,2369.5,2366.5,2356.9,2337.6,2319.0,2285.7,2258.4/
data time(108,1:8)/2390.4,2381.5,2378.6,2368.9,2349.6,2330.9,2297.6,2270.2/
data time(109,1:8)/2402.4,2393.5,2390.6,2380.8,2361.5,2342.8,2309.4,2281.9/
data time(110,1:8)/2414.3,2405.4,2402.5,2392.7,2373.4,2354.7,2321.2,2293.6/
data time(111,1:8)/2426.2,2417.3,2414.3,2404.6,2385.2,2366.4,2332.9,2305.2/
data time(112,1:8)/2438.0,2429.1,2426.1,2416.4,2397.0,2378.2,2344.5,2316.8/
data time(113,1:8)/2449.8,2440.8,2437.9,2428.1,2408.7,2389.8,2356.1,2328.3/
data time(114,1:8)/2461.5,2452.5,2449.6,2439.8,2420.3,2401.5,2367.7,2339.7/
data time(115,1:8)/2473.1,2464.2,2461.2,2451.4,2431.9,2413.0,2379.2,2351.1/
data time(116,1:8)/2484.7,2475.7,2472.8,2463.0,2443.5,2424.5,2390.6,2362.5/
data time(117,1:8)/2496.2,2487.3,2484.3,2474.5,2454.9,2436.0,2402.0,2373.7/
data time(118,1:8)/2507.7,2498.7,2495.7,2485.9,2466.3,2447.3,2413.3,2384.9/
data time(119,1:8)/2519.1,2510.1,2507.1,2497.3,2477.7,2458.7,2424.5,2396.1/
data time(120,1:8)/2530.4,2521.5,2518.5,2508.6,2489.0,2469.9,2435.7,2407.2/
data time(121,1:8)/2541.7,2532.7,2529.8,2519.9,2500.2,2481.1,2446.8,2418.3/
data time(122,1:8)/2553.0,2544.0,2541.0,2531.1,2511.4,2492.3,2457.9,2429.2/
data time(123,1:8)/2564.1,2555.1,2552.1,2542.2,2522.5,2503.4,2468.9,2440.2/
data time(124,1:8)/2575.2,2566.2,2563.2,2553.3,2533.6,2514.4,2479.9,2451.0/
data time(125,1:8)/2586.3,2577.3,2574.3,2564.3,2544.6,2525.4,2490.8,2461.9/
data time(126,1:8)/2597.3,2588.3,2585.3,2575.3,2555.5,2536.3,2501.6,2472.6/
data time(127,1:8)/2608.2,2599.2,2596.2,2586.2,2566.4,2547.1,2512.4,2483.3/
data time(128,1:8)/2619.1,2610.0,2607.0,2597.1,2577.2,2557.9,2523.1,2493.9/
data time(129,1:8)/2629.9,2620.9,2617.8,2607.8,2588.0,2568.6,2533.8,2504.5/
data time(130,1:8)/2640.7,2631.6,2628.6,2618.6,2598.7,2579.3,2544.4,2515.1/
data time(131,1:8)/2651.4,2642.3,2639.3,2629.2,2609.3,2589.9,2555.0,2525.5/
data time(132,1:8)/2662.0,2652.9,2649.9,2639.8,2619.9,2600.5,2565.4,2535.9/
data time(133,1:8)/2672.6,2663.5,2660.5,2650.4,2630.4,2611.0,2575.9,2546.3/
data time(134,1:8)/2683.1,2674.0,2671.0,2660.9,2640.9,2621.4,2586.2,2556.6/
data time(135,1:8)/2693.5,2684.4,2681.4,2671.3,2651.3,2631.8,2596.6,2566.8/
data time(136,1:8)/2703.9,2694.8,2691.8,2681.7,2661.6,2642.1,2606.8,2576.9/
data time(137,1:8)/2714.3,2705.1,2702.1,2692.0,2671.9,2652.4,2617.0,2587.0/
data time(138,1:8)/2724.5,2715.4,2712.4,2702.2,2682.1,2662.5,2627.1,2597.1/
data time(139,1:8)/2734.7,2725.6,2722.5,2712.4,2692.3,2672.7,2637.2,2607.0/
data time(140,1:8)/2744.9,2735.7,2732.7,2722.5,2702.4,2682.7,2647.2,2617.0/
data time(141,1:8)/2754.9,2745.8,2742.7,2732.6,2712.4,2692.7,2657.1,2626.8/
data time(142,1:8)/2765.0,2755.8,2752.7,2742.6,2722.4,2702.7,2667.0,2636.6/
data time(143,1:8)/2774.9,2765.8,2762.7,2752.5,2732.3,2712.5,2676.8,2646.4/
data time(144,1:8)/2784.8,2775.6,2772.6,2762.4,2742.1,2722.4,2686.5,2656.0/
data time(145,1:8)/2794.6,2785.5,2782.4,2772.2,2751.9,2732.1,2696.2,2665.6/
data time(146,1:8)/2804.4,2795.2,2792.1,2781.9,2761.6,2741.8,2705.8,2675.2/
data time(147,1:8)/2814.1,2804.9,2801.8,2791.6,2771.2,2751.4,2715.4,2684.6/
data time(148,1:8)/2823.7,2814.5,2811.4,2801.2,2780.8,2761.0,2724.9,2694.1/
data time(149,1:8)/2833.3,2824.1,2821.0,2810.7,2790.3,2770.5,2734.3,2703.4/
data time(150,1:8)/2842.8,2833.6,2830.5,2820.2,2799.8,2779.9,2743.7,2712.7/
data time(151,1:8)/2852.2,2843.0,2839.9,2829.6,2809.2,2789.2,2753.0,2721.9/
data time(152,1:8)/2861.6,2852.4,2849.3,2839.0,2818.5,2798.5,2762.2,2731.1/
data time(153,1:8)/2870.9,2861.7,2858.6,2848.3,2827.8,2807.8,2771.4,2740.1/

SStime=-12345.
if(dist<dmin .or. dist> dmax) return
if(dep<0. .or. dep> 700.) return

i0=min(152.,dist-dmin+1)
d0=dmin+(i0-1)
i1=i0+1
j1=2
do while (depth(j1)<dep)
  j1=j1+1
enddo
j0=j1-1
if(time(i0,j0).le.0.) return
if(time(i0,j1).le.0.) return
if(time(i1,j0).le.0.) return
if(time(i1,j1).le.0.) return
x=(dist-d0)
y=(dep-depth(j0))/(depth(j1)-depth(j0))
t0=time(i0,j0)+x*(time(i1,j0)-time(i0,j0))
t1=time(i0,j1)+x*(time(i1,j1)-time(i0,j1))
SStime=t0+y*(t1-t0)
!write(13,*) 'SS dep,dist:',dep,dist,'depth(j0)=',depth(j0),'t=',SStime
!write(13,*) 'i0,j0=',i0,j0,' d0,x,y=',d0,x,y
!write(13,*) 'times:',time(i0,j0),time(i1,j0),time(i0,j1),time(i1,j1)
!write(13,*) 'min, sec:',int(time(i0,j0)/60.),time(i0,j0)-int(time(i0,j0)/60.)*60.

return
end function

end module ttak135

